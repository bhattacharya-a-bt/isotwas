library(isotwas)
isotwas_model = compute_isotwas(X = snps$genotypes[],
Y = isoform_mat,
Y.rep = isoform_mat_rep,R = 10,
id = rownames(isoform_mat_rep),
omega_est = 'replicates',
omega_nlambda = 5,
method = c('mrce_lasso',
'multi_enet',
'univariate',
'mvsusie'),
predict_nlambda = 10,
family = 'gaussian',
scale = FALSE,
alpha = 0.5,
nfolds = 5,
verbose = FALSE,
tx_names = paste0('Isoform',1:3),
seed = 1789,
run_all = FALSE,
return_all = TRUE)
isotwas_model = compute_isotwas(X = snps$genotypes[],
Y = isoform_mat,
Y.rep = isoform_mat_rep,
R = 10,
id = rownames(isoform_mat_rep),
omega_est = 'replicates',
omega_nlambda = 5,
method = c('mrce_lasso',
'multi_enet',
'univariate',
'mvsusie'),
predict_nlambda = 10,
family = 'gaussian',
scale = FALSE,
alpha = 0.5,
nfolds = 5,
verbose = FALSE,
tx_names = paste0('Isoform',1:3),
seed = 1789,
run_all = FALSE,
return_all = TRUE)
train_bed = system.file("extdata", "train.bed", package = "isotwas")
snps = bigsnpr::snp_attach(bigsnpr::snp_readBed2(train_bed,
backingfile = tempfile()))
dim(snps$genotypes[])
isoform_mat = readRDS(system.file("extdata", "isoform_exp.RDS", package = "isotwas"))
dim(isoform_mat)
boot_list = lapply(1:10,function(i){jitter(isoform_mat)})
isoform_mat_rep = rlist::list.rbind(boot_list)
rownames(isoform_mat_rep) = rep(paste0('Sample',1:nrow(snps$fam)),10)
colnames(isoform_mat_rep) = paste0('Isoform',1:ncol(isoform_mat_rep))
dim(isoform_mat_rep)
isotwas_model = compute_isotwas(X = snps$genotypes[],
Y = isoform_mat,
Y.rep = isoform_mat_rep,
R = 10,
id = rownames(isoform_mat_rep),
omega_est = 'replicates',
omega_nlambda = 5,
method = c('mrce_lasso',
'multi_enet',
'univariate',
'mvsusie'),
predict_nlambda = 10,
family = 'gaussian',
scale = FALSE,
alpha = 0.5,
nfolds = 5,
verbose = FALSE,
tx_names = paste0('Isoform',1:3),
seed = 1789,
run_all = FALSE,
return_all = TRUE)
isotwas_model
isotwas_model$Model
isotwas_tsv = convert_model(isotwas_model)
isotwas_tsv
unique(isotwas_tsv$Transcript)
isotwas_model$Model[[3]]
