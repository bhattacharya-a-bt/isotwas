<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Create Isoform Similarity Matrix from GTF — similarity_from_gtf • isotwas</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Create Isoform Similarity Matrix from GTF — similarity_from_gtf"><meta name="description" content="Parses a GTF file and creates a similarity matrix for isoforms of a specified
gene based on shared exon structure. This matrix can be used with
multivariate_graph_reg for graph-regularized prediction."><meta property="og:description" content="Parses a GTF file and creates a similarity matrix for isoforms of a specified
gene based on shared exon structure. This matrix can be used with
multivariate_graph_reg for graph-regularized prediction."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">isotwas</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/motivation.html">Motivation for isotwas</a></li>
    <li><a class="dropdown-item" href="../articles/pipeline.html">Train an isoTWAS model</a></li>
    <li><a class="dropdown-item" href="../articles/stageassoc.html">Run isoTWAS associations</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Create Isoform Similarity Matrix from GTF</h1>

      <div class="d-none name"><code>similarity_from_gtf.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Parses a GTF file and creates a similarity matrix for isoforms of a specified
gene based on shared exon structure. This matrix can be used with
<code><a href="multivariate_graph_reg.html">multivariate_graph_reg</a></code> for graph-regularized prediction.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">similarity_from_gtf</span><span class="op">(</span></span>
<span>  <span class="va">gtf_path</span>,</span>
<span>  <span class="va">gene</span>,</span>
<span>  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"jaccard"</span>, <span class="st">"overlap_coef"</span>, <span class="st">"binary"</span><span class="op">)</span>,</span>
<span>  transcript_ids <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  min_transcripts <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-gtf-path">gtf_path<a class="anchor" aria-label="anchor" href="#arg-gtf-path"></a></dt>
<dd><p>character, path to GTF file (can be gzipped)</p></dd>


<dt id="arg-gene">gene<a class="anchor" aria-label="anchor" href="#arg-gene"></a></dt>
<dd><p>character, gene name (HGNC symbol) or Ensembl gene ID</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>character, similarity method:</p><ul><li><p>"jaccard": Jaccard index based on exon overlap (default)</p></li>
<li><p>"overlap_coef": Overlap coefficient = overlap / min(length_i, length_j)</p></li>
<li><p>"binary": 1 if any overlap, 0 otherwise</p></li>
</ul></dd>


<dt id="arg-transcript-ids">transcript_ids<a class="anchor" aria-label="anchor" href="#arg-transcript-ids"></a></dt>
<dd><p>character vector, optional subset of transcript IDs to include.
If NULL, uses all transcripts for the gene.</p></dd>


<dt id="arg-min-transcripts">min_transcripts<a class="anchor" aria-label="anchor" href="#arg-min-transcripts"></a></dt>
<dd><p>int, minimum number of transcripts required (default 2)</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>logical, print progress messages</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list containing:</p><ul><li><p>similarity_matrix: symmetric matrix of pairwise isoform similarities</p></li>
<li><p>transcript_ids: character vector of transcript IDs (matrix row/col names)</p></li>
<li><p>gene_id: matched gene identifier</p></li>
<li><p>n_transcripts: number of transcripts</p></li>
<li><p>n_exons: named vector of exon counts per transcript</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The function computes pairwise similarity between isoforms based on their
exon structure. Isoforms that share more exonic sequence are considered
more similar, reflecting the biological intuition that they likely share
more cis-regulatory effects.</p>
<p>The Jaccard similarity is computed as:
$$J(i,j) = \frac{|overlap(exons_i, exons_j)|}{|union(exons_i, exons_j)|}$$</p>
<p>where overlap and union are computed in terms of genomic base pairs.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># Create similarity matrix for BRCA1 isoforms</span></span></span>
<span class="r-in"><span><span class="va">sim</span> <span class="op">&lt;-</span> <span class="fu">similarity_from_gtf</span><span class="op">(</span><span class="st">"gencode.v45.annotation.gtf.gz"</span>, <span class="st">"BRCA1"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Use with graph-regularized prediction</span></span></span>
<span class="r-in"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="multivariate_graph_reg.html">multivariate_graph_reg</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">Y</span>, similarity_matrix <span class="op">=</span> <span class="va">sim</span><span class="op">$</span><span class="va">similarity_matrix</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Arjun Bhattacharya.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

