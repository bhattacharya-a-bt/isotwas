[{"path":"https://bhattacharya-a-bt.github.io/isotwas/articles/motivation.html","id":"key-features","dir":"Articles","previous_headings":"","what":"Key Features","title":"Motivation for isotwas","text":"Multiple prediction methods: package automatically evaluates multiple multivariate regression methods selects best model based cross-validated R-squared. Graph-regularized learning: Incorporate prior knowledge isoform similarity (e.g., shared exon structure) improve predictions. User-friendly interface: main compute_isotwas() function provides detailed progress output, data summaries, results comparison tables. Robust model selection: Uses cross-validation within method compares across methods find optimal model gene. See Train isoTWAS model vignette detailed usage instructions.","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/articles/pipeline.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Train an isoTWAS model","text":"module cover use functions isotwas train multivariate isotwas model isoform-level expression. Along way, ’ll covering practical considerations computation feature selection.","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/articles/pipeline.html","id":"train-predictive-model","dir":"Articles","previous_headings":"","what":"Train predictive model","title":"Train an isoTWAS model","text":"train multivariate model, need: matrix dosages SNPs, matrix isoform-level expressions given gene. Isoform expression estimated pseudo-alignment methods like salmon kallisto provide bootstrapped estimates expression across number iterations. information can included model training, illustrated . Practical consideration: Ideally, reduce memory usage, recommend storing genetic data PLINK format data (ideally .bed/bim/fam .pgen/.pvar/.psam). given gene, use PLINK select SNPs chromosome within 1 Megabase gene body. , can use bigsnpr package read “condensed” file set. Make sure isoform expression matrix log-transformed residualized covariates normally used QTL analysis (.e., age, sex, principal components genotype matrix, PEER factors hidden covariates prior full expression matrix). order ensure maximal overlap model GWAS eventually use trait mapping, suggest restricting SNPs QTL panel present LD reference panel annotated HapMap3 Project. ensure proper standard error calculations. vignette training model, ’ll use toy genetic transcriptomic data provided. reads SNP matrix dimensions 300×4542300 \\times 4542, samples along rows SNPs along columns isoform-level expression matrix dimension 300×3300 \\times 3, isoforms along columns. Practical consideration: Though requirement isotwas pipeline, recommend feature selection step based cis-heritability isoform-level expression. Prior model training isoforms given gene, recommend users compute heritability expressed isoforms gene using GCTA (ideally gcta-nr-robust executable FUSION). recommend users train models isoforms positive heritability nominal P<0.05P < 0.05 0.010.01. Practical consideration: Prior heritability analysis model training, imperative expression data residualized relevant covariates (.e. principal components genotype matrix, hidden covariates PEER factors expression matrix, clinical/demographic covariates). general rule thumb include covariate eQTL/isoform-level eQTL analysis, include residualization process. Let’s jitter expression matrix little generate 10 bootstrapped estimates matrix. Keep mind replicates, theoretically, affect effect size estimates help seeding estimation process correlation isoforms/error multivariate model.","code":"train_bed = system.file(\"extdata\", \"train.bed\", package = \"isotwas\") snps = bigsnpr::snp_attach(bigsnpr::snp_readBed2(train_bed,                                                  backingfile = tempfile())) dim(snps$genotypes[]) #> [1]  300 4542  isoform_mat = readRDS(system.file(\"extdata\", \"isoform_exp.RDS\", package = \"isotwas\")) dim(isoform_mat) #> [1] 300   3 boot_list = lapply(1:10,function(i){jitter(isoform_mat)}) isoform_mat_rep = rlist::list.rbind(boot_list) rownames(isoform_mat_rep) = rep(paste0('Sample',1:nrow(snps$fam)),10) colnames(isoform_mat_rep) = paste0('Isoform',1:ncol(isoform_mat_rep)) dim(isoform_mat_rep) #> [1] 3000    3"},{"path":"https://bhattacharya-a-bt.github.io/isotwas/articles/pipeline.html","id":"available-prediction-methods","dir":"Articles","previous_headings":"","what":"Available Prediction Methods","title":"Train an isoTWAS model","text":"compute_isotwas() function supports 9 multivariate prediction methods:","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/articles/pipeline.html","id":"training-a-model","dir":"Articles","previous_headings":"","what":"Training a Model","title":"Train an isoTWAS model","text":"Now, can train model using compute_isotwas() function. Make sure SNP matrix clear labels SNP identifiers relevant study. function now provides detailed progress output default (verbose = TRUE), showing: Data summary (samples, SNPs, transcripts) Method--method progress timing Per-method R² performance Final results comparison table","code":"snp_mat = as.matrix(snps$genotypes[]) colnames(snp_mat) = snps$map$marker.ID rownames(snp_mat) = snps$fam$sample.ID  # Train with all methods (recommended for best model selection) isotwas_model = compute_isotwas(   X = snp_mat,   Y = isoform_mat,   Y.rep = isoform_mat_rep,   R = 10,   id = rownames(isoform_mat_rep),   omega_est = 'replicates',   omega_nlambda = 5,   nfolds = 5,   verbose = TRUE,   seed = 1789,   run_all = TRUE,        # Run all 9 methods   return_all = TRUE      # Return results from all methods )"},{"path":"https://bhattacharya-a-bt.github.io/isotwas/articles/pipeline.html","id":"running-specific-methods","dir":"Articles","previous_headings":"Training a Model","what":"Running Specific Methods","title":"Train an isoTWAS model","text":"want run specific methods (e.g., faster computation), set run_all = FALSE specify methods:","code":"# Run only a subset of methods isotwas_model = compute_isotwas(   X = snp_mat,   Y = isoform_mat,   Y.rep = isoform_mat_rep,   R = 10,   id = rownames(isoform_mat_rep),   method = c('mrce_lasso', 'multi_enet', 'sgl', 'univariate'),   nfolds = 5,   verbose = TRUE,   seed = 1789,   run_all = FALSE )"},{"path":"https://bhattacharya-a-bt.github.io/isotwas/articles/pipeline.html","id":"using-graph-regularized-regression","dir":"Articles","previous_headings":"Training a Model","what":"Using Graph-Regularized Regression","title":"Train an isoTWAS model","text":"graph_reg method can incorporate prior knowledge isoform similarity (e.g., shared exon structure). can create similarity matrix GTF annotation file:","code":"# Create similarity matrix from GTF (based on shared exons) sim_result = similarity_from_gtf(   gtf_path = \"gencode.v45.annotation.gtf.gz\",   gene = \"BRCA1\",   method = \"jaccard\"  # Options: \"jaccard\", \"overlap_coef\", \"binary\" )  # Use in model training isotwas_model = compute_isotwas(   X = snp_mat,   Y = isoform_mat,   Y.rep = isoform_mat_rep,   R = 10,   id = rownames(isoform_mat_rep),   similarity_matrix = sim_result$similarity_matrix,   method = c('multi_enet', 'graph_reg', 'univariate'),   run_all = FALSE,   verbose = TRUE,   seed = 1789 )"},{"path":"https://bhattacharya-a-bt.github.io/isotwas/articles/pipeline.html","id":"function-parameters","dir":"Articles","previous_headings":"","what":"Function Parameters","title":"Train an isoTWAS model","text":"notes key options: omega_est: selecting omega_est = 'replicates', use bootstrapped replicates estimate correlation isoforms. alternative omega_est = 'mean', use whatever matrix submit Y. omega_nlambda: Number steps fully dense fully sparse correlation matrix estimation. recommend 5-10 default. method: Vector methods use. default run_all = TRUE, 9 methods run best model selected. similarity_matrix: Optional matrix graph_reg method. Can created using similarity_from_gtf() create_similarity_from_exons(). predict_nlambda: Number penalty variables mrce_lasso. recommend 10-20. alpha: Elastic net mixing parameter (0 = ridge, 1 = lasso, 0.5 = elastic net). verbose: TRUE (default), prints detailed progress including per-method timing performance. run_all: TRUE, methods run regardless method parameter. return_all: TRUE, results methods returned (useful method comparison).","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/articles/pipeline.html","id":"examining-results","dir":"Articles","previous_headings":"","what":"Examining Results","title":"Train an isoTWAS model","text":"output compute_isotwas() isotwas_result object several components:","code":"# Print summary print(isotwas_model)  # Access the comparison table (R² for each method) isotwas_model$comparison  # Access the best model isotwas_model$best_models  # Access individual transcript results isotwas_model$best_models$Isoform1$r2 isotwas_model$best_models$Isoform1$weights  # Get the full weight matrix weight_mat = get_weight_matrix(isotwas_model$best_models)"},{"path":"https://bhattacharya-a-bt.github.io/isotwas/articles/pipeline.html","id":"converting-the-model","dir":"Articles","previous_headings":"","what":"Converting the Model","title":"Train an isoTWAS model","text":"can convert model list tibble data.frame using convert_model(): Let’s take look sample model looks like: model object list Model R2 slot. Model slot stores list models isoform. can convert model list tibble using convert_model() function. Make sure annotation object position REF/ALT allele information.","code":"model_isotwas = readRDS(system.file(\"extdata\", \"model_example.RDS\", package = \"isotwas\")) class(model_isotwas) #> [1] \"list\" length(model_isotwas) #> [1] 2 names(model_isotwas) #> [1] \"Model\" \"R2\" model_isotwas$Model[[1]] #> $Transcript #> [1] \"Isoform1\" #>  #> $Model #> # A tibble: 187 × 2 #>    SNP        Weight #>    <chr>       <dbl> #>  1 SNP10  -0.0000957 #>  2 SNP19  -0.00158   #>  3 SNP80  -0.00375   #>  4 SNP89  -0.000884  #>  5 SNP94  -0.00504   #>  6 SNP124  0.00586   #>  7 SNP195 -0.0201    #>  8 SNP232 -0.00627   #>  9 SNP233  0.000960  #> 10 SNP261 -0.00688   #> # ℹ 177 more rows #>  #> $R2 #> [1] 0.3174829 #>  #> $P #> value  #>     0  #>  #> $Pred #>       IND190       IND380       IND130       IND314       IND462       IND137  #> -0.395051620 -0.405521454 -0.405642239 -0.513143425 -0.219109235 -0.472395293  #>       IND191       IND228       IND253       IND358       IND318         IND3  #> -0.186011347 -0.047232532 -0.039820719 -0.203023847 -0.279393749 -0.177154706  #>        IND28       IND182        IND91       IND476       IND255       IND209  #> -0.261468441 -0.572125420 -0.351933854 -0.493579401 -0.417614473 -0.059488250  #>       IND135       IND223       IND340       IND120       IND115       IND391  #> -0.318086976 -0.319871820 -0.135863999  0.083039071 -0.469286056 -0.281497318  #>       IND304       IND163       IND386        IND69       IND121       IND269  #> -0.342756842 -0.169790486 -0.552650084 -0.339994140  0.018921426 -0.359762240  #>        IND24        IND31       IND349        IND32       IND332       IND495  #> -0.171493417 -0.450912106 -0.411439831 -0.220513041 -0.445241556 -0.302148360  #>       IND328       IND371       IND272        IND23        IND55       IND463  #> -0.572640195 -0.090248595 -0.172602006 -0.107964558 -0.450873553 -0.297293819  #>       IND194       IND441       IND113        IND47       IND502       IND409  #>  0.002500033 -0.082561510 -0.053926154  0.014315858 -0.263294983 -0.424747059  #>        IND82        IND48       IND303       IND176       IND393        IND52  #> -0.215259827 -0.180472021 -0.566428240 -0.154369420 -0.292469824 -0.125122866  #>       IND458       IND426        IND15        IND10       IND211       IND244  #> -0.297137749 -0.571241703 -0.271153164 -0.372562537 -0.139310663  0.058872696  #>        IND65        IND50       IND442       IND213       IND157       IND300  #> -0.353977257 -0.370280430 -0.369661968 -0.308463656 -0.015128680 -0.372327867  #>        IND25       IND254        IND49       IND199       IND189       IND295  #> -0.294685131  0.207142198 -0.265891894 -0.210070398 -0.125493031 -0.208084001  #>        IND88       IND459       IND339        IND46       IND325       IND419  #> -0.188952067 -0.341369214 -0.323699038 -0.194042453 -0.177038660  0.040164417  #>       IND302       IND216       IND178       IND282       IND186       IND239  #> -0.388742683 -0.144205644 -0.215211141 -0.347436381  0.070054061 -0.016246983  #>        IND89        IND71        IND33       IND494       IND369       IND109  #> -0.558938422 -0.009956788 -0.518804964 -0.397442503 -0.462158482 -0.620882241  #>        IND64       IND364         IND1       IND323        IND60       IND151  #> -0.470768744 -0.505031962 -0.474205183 -0.369106906 -0.183303208 -0.474395370  #>       IND293       IND437        IND85       IND324       IND375       IND423  #> -0.216436666 -0.452684526 -0.437603184 -0.588708106 -0.588703304 -0.443682464  #>       IND367       IND516        IND95       IND461       IND451        IND76  #> -0.601498157 -0.233798606 -0.410275308 -0.511844894 -0.326213821 -0.370696978  #>       IND298       IND310       IND222       IND102       IND491       IND422  #> -0.502436692 -0.408828852 -0.111287912 -0.226551260 -0.223498530  0.158679573  #>       IND351       IND309       IND277       IND214         IND0       IND438  #> -0.344041151 -0.424716100 -0.612379239 -0.231148880 -0.417714624 -0.438855224  #>       IND453       IND400       IND443       IND227       IND331       IND169  #> -0.594149200 -0.385144435 -0.456708590 -0.532575545 -0.315295504 -0.235696550  #>       IND197       IND142       IND416        IND51       IND346        IND27  #> -0.298466128  0.034104976 -0.526523901  0.508010660 -0.126042297 -0.128398444  #>       IND297       IND479       IND488       IND290        IND44       IND308  #> -0.259539348 -0.454747553 -0.504412520 -0.510470021 -0.142340184  0.072124794  #>       IND486         IND7       IND284       IND444       IND220       IND374  #> -0.329956853 -0.350941227 -0.163496962 -0.413414477 -0.593246582 -0.818095517  #>       IND500        IND11       IND354       IND246       IND439       IND392  #> -0.501920608 -0.214219476  0.007729149 -0.275404004 -0.644399750 -0.285348795  #>       IND448       IND506       IND192       IND484       IND203       IND452  #> -0.492513383 -0.310190245 -0.024709405 -0.435482280 -0.269321957 -0.552898172  #>        IND92       IND134       IND287       IND424       IND307       IND122  #> -0.101055241  0.008905316 -0.306358542 -0.461001763 -0.356879362  0.058371001  #>       IND414       IND212        IND20       IND127       IND236       IND258  #> -0.311646715 -0.111162671 -0.193471243  0.028880043 -0.407672480  0.142610577  #>       IND305       IND268       IND513       IND496       IND147       IND322  #> -0.340565157 -0.471679317 -0.404866473 -0.395120760 -0.072070907 -0.277843970  #>        IND45        IND68       IND201       IND348        IND43        IND75  #>  0.035081966 -0.363338384 -0.652974372 -0.412158936 -0.071163309 -0.080312324  #>        IND90        IND41       IND387       IND276       IND465       IND224  #>  0.025514564 -0.323200418 -0.477190145 -0.154720858 -0.341964318 -0.196673915  #>       IND481       IND143       IND226       IND480       IND126       IND498  #> -0.663275058 -0.056703898 -0.082764588 -0.210979906  0.048488465 -0.283945815  #>       IND233       IND195        IND61       IND173        IND97       IND478  #> -0.266472867 -0.217675991  0.014263476 -0.454493334 -0.550484287 -0.041911623  #>        IND18       IND397       IND180       IND315       IND338       IND359  #> -0.330665666 -0.436392508 -0.609082779 -0.569036586 -0.212491654 -0.343991921  #>       IND508       IND101       IND232       IND454       IND145       IND370  #> -0.477263014 -0.464338378 -0.072071562 -0.227516541 -0.389293368 -0.173894914  #>       IND159        IND12        IND77       IND421       IND112       IND289  #>  0.119232022 -0.094999753 -0.481360824 -0.433878747 -0.100941994 -0.581080319  #>       IND353       IND235        IND29       IND221       IND335       IND249  #> -0.332866777 -0.078403530 -0.340509458 -0.130391230 -0.223907121 -0.298415252  #>        IND84       IND296       IND183       IND344       IND259       IND384  #> -0.199496411 -0.410031721 -0.377059571 -0.693998245 -0.370623474 -0.246649423  #>       IND148       IND485       IND264        IND54       IND119       IND146  #> -0.271335029 -0.225853454 -0.261874967  0.087807798 -0.158416463 -0.214176185  #>        IND93        IND80        IND16       IND350       IND503       IND490  #> -0.420587615 -0.521984344 -0.070014457 -0.477095206 -0.366749255 -0.412342395  #>       IND270        IND70       IND385       IND433       IND428       IND280  #> -0.502675568 -0.087020068 -0.312957603 -0.141636588 -0.630821691 -0.190763136  #>       IND234       IND104       IND155       IND417       IND207        IND67  #> -0.145463209 -0.065338172 -0.102717325 -0.406053957 -0.487929907 -0.542512235  #>       IND471         IND6       IND413       IND412       IND245        IND96  #>  0.034250790 -0.327396727 -0.497126708 -0.185326538 -0.331678057 -0.078888704  #>        IND63       IND301       IND401       IND263       IND352       IND316  #> -0.238519359 -0.297359129 -0.424067348 -0.282617895 -0.050625075 -0.255118778  #>       IND341       IND489       IND388       IND457       IND181       IND431  #> -0.459988827 -0.313308038 -0.311893938  0.040361232 -0.454678575 -0.575772676  #>       IND140       IND512       IND330       IND420       IND377       IND139  #> -0.218079182 -0.400390897 -0.392403815 -0.258866066 -0.353999148  0.032783885  #>       IND171       IND165       IND395       IND436       IND475       IND167  #>  0.002110163 -0.083110045 -0.540800075 -0.680934271 -0.444409304 -0.160315170  #>       IND111       IND473       IND379       IND501       IND164       IND360  #> -0.189364791 -0.415996781 -0.534266922 -0.437482227 -0.269667607 -0.244362503  #>       IND390       IND376       IND425        IND66       IND243        IND39  #> -0.016687981 -0.300365083 -0.559132052 -0.397677303 -0.253962997 -0.157969029  #>       IND125        IND59       IND218       IND361       IND469       IND321  #>  0.198755812 -0.270404134 -0.157473118 -0.435929952 -0.198513588 -0.471754809 model_tsv = convert_model(model_isotwas,                           snp_annot = snps$map,                           snp_var = 'marker.ID') model_tsv #> # A tibble: 700 × 10 #>    SNP        Weight Transcript    R2  R2.P chromosome genetic.dist physical.pos #>    <chr>       <dbl> <chr>      <dbl> <dbl>      <int>        <int>        <int> #>  1 SNP10    -9.57e-5 Isoform1   0.317     0          1            0        10099 #>  2 SNP100   -2.42e-3 Isoform3   0.425     0          1            0       100107 #>  3 SNP1009   2.15e-3 Isoform3   0.425     0          1            0      1009108 #>  4 SNP101    8.68e-3 Isoform2   0.463     0          1            0       101086 #>  5 SNP1012  -1.99e-2 Isoform1   0.317     0          1            0      1012093 #>  6 SNP1017  -7.31e-3 Isoform2   0.463     0          1            0      1017093 #>  7 SNP1020   4.89e-3 Isoform2   0.463     0          1            0      1020103 #>  8 SNP1025   3.36e-2 Isoform1   0.317     0          1            0      1025113 #>  9 SNP103   -5.00e-2 Isoform2   0.463     0          1            0       103078 #> 10 SNP1042  -1.09e-2 Isoform2   0.463     0          1            0      1042088 #> # ℹ 690 more rows #> # ℹ 2 more variables: allele1 <chr>, allele2 <chr>"},{"path":"https://bhattacharya-a-bt.github.io/isotwas/articles/pipeline.html","id":"method-recommendations","dir":"Articles","previous_headings":"","what":"Method Recommendations","title":"Train an isoTWAS model","text":"Based simulations real data analyses: Default recommendation: Use run_all = TRUE evaluate methods let function select best model based cross-validated R². speed: computation time concern, start c('multi_enet', 'sgl', 'univariate') provides good balance multivariate univariate approaches. isoforms share structure: Use graph_reg similarity matrix derived shared exons. helps isoforms correlated genetic effects due shared regulatory regions. robust predictions: stacking method combines multiple base methods often provides stable predictions, especially different methods perform well different isoforms. joint feature selection: Use mtlasso sgl expect SNPs affect multiple isoforms simultaneously.","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/articles/stageassoc.html","id":"pre-computed-models-and-ld-matrix","dir":"Articles","previous_headings":"","what":"Pre-computed models and LD matrix","title":"Run isoTWAS associations","text":"can always use set models trained isoform expression QTL data (paired genotype RNA-seq data). convenience, trained made publicly available isoTWAS models 48 tissues Genotype-Tissue Expression Project (GTEx), adult brain cortex PsychENCODE AMP-AD, developmental brain cortex PsychENCODE. Zenodo repositories GTEx, adult cortex, developmental cortex models. Please cite manuscript associated Zenodo DOI use models. download entire Zenodo repository, may use Python package Zenodo_get (https://zenodo.org/record/1261813). install use, sample commands directly download adult cortex repository Zenodo: tutorial, using isoTWAS models 3 genes: CDC42 (ENSG00000070831), WNT4 (ENSG00000162552), CDC42-IT1 (ENSG00000230068). Let’s take look models look like, saved .RDS files. train models, ensure model files contain columns : isoform name, SNP name rsID, chromosome SNP, position SNP, alternative allele, reference allele, predictive weight isoform. reference, models include genome build model trained, users can align GWAS models based genome build. also include -sample LD matrices isoTWAS model. simply .RDS files contain square matrix LD SNPs correspondin row column. Note column row names matrix correspond rsIDs model. Practical consideration: many settings, corresponding file contains LD matrix SNPs locus. case, suggest either one two approaches. First, can generate LD matrix data model trained, access individual-level genotypes data. Alternatively, can use LD reference panel well-aligned genetic ancestry training dataset. LD reference panel usually 1000 Genomes, since ’s publicly available. can use bigsnpr::snp_cor bigsnpr::bed_cor generate similar-looking LD matrices, given PLINK style files (.bed/.bim/.fam) LD reference.","code":"pip install zenodo-get zenodo_get 8048198 set.seed(1789) model_test = readRDS(system.file(\"extdata\",                                  \"ENSG00000070831_isoTWAS.RDS\",                                  package = \"isotwas\")) head(model_test) ##           Feature        SNP Chromosome Position Build ALT REF        Weight ## 2 ENST00000344548 rs10917023          1 21599110  hg38   A   G  0.0257706583 ## 3 ENST00000344548 rs10917145          1 22086152  hg38   A   G -0.2503237794 ## 4 ENST00000344548 rs11584687          1 22550747  hg38   A   G  0.0200388736 ## 5 ENST00000344548 rs12082914          1 21493245  hg38   G   T  0.0167839153 ## 6 ENST00000344548 rs12118362          1 21445504  hg38   G   A  0.0133152139 ## 7 ENST00000344548 rs12127343          1 21543280  hg38   A   G  0.0007759457 ##           R2            Gene ## 2 0.09314035 ENSG00000070831 ## 3 0.09314035 ENSG00000070831 ## 4 0.09314035 ENSG00000070831 ## 5 0.09314035 ENSG00000070831 ## 6 0.09314035 ENSG00000070831 ## 7 0.09314035 ENSG00000070831 LD_test = readRDS(system.file(\"extdata\",                               \"ENSG00000070831_LDMatrix.RDS\",                               package = \"isotwas\")) head(as.matrix(LD_test)[,1:10]) ## Loading required package: Matrix ##            rs10916927  rs6658526  rs1354792 rs12567861 rs10916930  rs7521711 ## rs10916927  1.0000000  0.9440432  0.8544395 -0.6393393 -0.6405133  0.8536513 ## rs6658526   0.9440432  1.0000000  0.8005756 -0.5896286 -0.5924963  0.7998371 ## rs1354792   0.8544395  0.8005756  1.0000000 -0.7649469 -0.7657869  0.9990775 ## rs12567861 -0.6393393 -0.5896286 -0.7649469  1.0000000  0.9971883 -0.7642413 ## rs10916930 -0.6405133 -0.5924963 -0.7657869  0.9971883  1.0000000 -0.7650804 ## rs7521711   0.8536513  0.7998371  0.9990775 -0.7642413 -0.7650804  1.0000000 ##             rs4654899   rs960564  rs6663452  rs7532667 ## rs10916927  0.9097877  0.9966544  0.9501309  0.9971286 ## rs6658526   0.8503948  0.9427488  0.8973393  0.9458899 ## rs1354792   0.9361329  0.8530981  0.8951509  0.8538566 ## rs12567861 -0.7173327 -0.6390579 -0.6724022 -0.6393520 ## rs10916930 -0.7179086 -0.6402319 -0.6737519 -0.6405219 ## rs7521711   0.9371127  0.8532494  0.8952461  0.8530689"},{"path":"https://bhattacharya-a-bt.github.io/isotwas/articles/stageassoc.html","id":"preparing-the-gwas-summary-statistics","dir":"Articles","previous_headings":"","what":"Preparing the GWAS summary statistics","title":"Run isoTWAS associations","text":"last file need GWAS summary statistics trait interest. tutorial, using GWAS summary statistics schizophrenia, made available Psychiatric Genomics Consortium. specifically using GWAS summary statistics European-ancestry individual. can find files : https://figshare.com/articles/dataset/scz2022/19426775. Since GWAS summary statistics often varied column names, use munging script clean data. addition, subset GWAS summary statistics SNPs annotated HapMap3 ensure maximal overlap. munging script available , courtesy Michael Margolis. tutorial, subsetted SNPs within locus example genes. Let’s take look munged file. munged summary statistics table 5 columns: SNP rsID, alternative allele, reference allele, Z-score (beta value divided standard error) GWAS association, effective sample size. advise use munging script format summary statistics files. least, please ensure summary statistics file contains column SNP identifier, alternative allele, either Z-score beta value standard error SNP.","code":"gwas = read.table(system.file(\"extdata\",                               \"tutorial_SCZ_2022.hm3_filter.sumstats.gz\",                               package = \"isotwas\"),                   header=T) head(gwas) ##          SNP A1 A2      Z        N ## 1 rs10916927  T  C  3.108 146347.8 ## 2  rs6658526  C  T  2.954 146347.8 ## 3  rs1354792  T  C  1.636 146347.8 ## 4 rs12567861  C  T -1.641 146347.8 ## 5 rs10916930  T  C -1.684 146347.8 ## 6  rs7521711  A  G  1.627 146347.8"},{"path":"https://bhattacharya-a-bt.github.io/isotwas/articles/stageassoc.html","id":"generating-nominal-z-scores","dir":"Articles","previous_headings":"","what":"Generating nominal Z-scores","title":"Run isoTWAS associations","text":"first step isoTWAS trait-mapping generate isoform-level Z-scores using weighted burden test. general, ’ll vector gene names corresponding isoTWAS model files /LD files. following code snippet loops vector genes, reads model file LD file, computes Z-score isoform gene well-predicted cross-validation. out_df variable contains data frame 7 columns: gene name, isoform name, isoform-level Z-score trait association, P-value corresponding Z-score, permutation P-value (), top SNP based GWAS P-value within 1 Mb gene locus, P-value corresponding GWAS SNP. permutation test test assesses much signal added isoform expression, given GWAS architecture locus, controls large LD blocks. shuffle SNP--isoform weights generate null distribution use null generate permutation P-value. run permutation test nominal P-value isoform-level Z-score less alpha, defined burdenTest function.","code":"gene_names = c('ENSG00000070831',                'ENSG00000162552',                'ENSG00000230068') out_df = data.frame(Gene = c(),                     Feature = c(),                     Z = c(),                     P = c(),                     permute.P = c(),                     topSNP = c(),                     topSNP.P = c())  for (gene in gene_names){      model = readRDS(system.file(\"extdata\",                               paste0(gene,\"_isoTWAS.RDS\"),                               package = \"isotwas\"))   ld = readRDS(system.file(\"extdata\",                            paste0(gene,\"_LDMatrix.RDS\"),                            package = \"isotwas\"))      for (tx in unique(model$Feature)){          sumstats.cur = subset(gwas,SNP %in% subset(model, Feature == tx)$SNP)     tx_df = isotwas::burdenTest(mod = subset(model, Feature == tx),                        ld = ld,                        gene = gene,                        sumStats = sumstats.cur,                        chr = 'Chromosome',                        pos = 'Position',                        a1 = 'A1',                        a2 = 'A2',                        a1_mod = 'ALT',                        a2_mod = 'REF',                        snpName = 'SNP',                        Z = 'Z',                        beta = NULL,                        se = NULL,                        featureName = 'Feature',                        R2cutoff = .01,                        alpha = 1e-3,                        nperms = 1000,                        usePos = F)     out_df = rbind(out_df,tx_df)        } } ## Registered S3 methods overwritten by 'huge': ##   method    from ##   plot.roc  pROC ##   plot.sim  lava ##   print.roc pROC ##   print.sim lava ## Registered S3 methods overwritten by 'spls': ##   method         from  ##   predict.splsda caret ##   print.splsda   caret head(out_df) ##              Gene         Feature         Z            P  permute.P     topSNP ## 1 ENSG00000070831 ENST00000344548 -3.239210 0.0011986108 1.00000000  rs2143103 ## 2 ENSG00000070831 ENST00000315554  1.268410 0.2046514827 1.00000000 rs11582542 ## 3 ENSG00000070831 ENST00000656825  3.268385 0.0010816323 1.00000000 rs11582542 ## 4 ENSG00000070831 ENST00000498236 -2.906460 0.0036554386 1.00000000 rs11582542 ## 5 ENSG00000070831 ENST00000400259  3.344840 0.0008232993 0.01198801 rs11582542 ## 6 ENSG00000070831 ENST00000667384  0.575199 0.5651567515 1.00000000 rs11582542 ##       topSNP.P ## 1 0.0004331767 ## 2 0.0003396706 ## 3 0.0003396706 ## 4 0.0003396706 ## 5 0.0003396706 ## 6 0.0003396706"},{"path":"https://bhattacharya-a-bt.github.io/isotwas/articles/stageassoc.html","id":"stage-wise-hypothesis-test","dir":"Articles","previous_headings":"","what":"Stage-wise hypothesis test","title":"Run isoTWAS associations","text":"isoTWAS employs two-step testing framework. First, control false discovery rate (FDR) across gene families, using either Benjamini-Hochberg FDR control (recommended) Bonferroni. Next, genes pass FDR control (adjusted P-values genes lower defined significance threshold), drop isoform level run family-wise error rate (FWER) control using Shaffer’s modified sequentially rejective Bonferroni procedure. , controlling FDR (alpha1) FWER (alpha2) 0.05. Let’s run first stage now: gene-level FDR control. see , gene-level, 3 genes pass FDR control. , see adjusted screening P-value less 0.05 3 genes. Now, drop isoform level 3 genes. Let’s run second stage: isoform-level FWER control gene families. now generated screening gene-level FDR-adjusted P-values confirmation isoform-level FWER controlled P-values. see 3 isoforms locus pass 3 levels hypothesis testing: screening FDR-adjusted P < 0.05, confirmation FWER-adjusted P < 0.05, nominal permutation P < 0.05. isoforms ENST00000400259 (gene: ENSG00000070831), ENST00000290167 (gene: ENSG00000162552), ENST00000431803 (gene: ENSG00000230068).","code":"suppressPackageStartupMessages(library(tidyverse)) gene = out_df %>%   group_by(Gene) %>%   summarise(Screen.P = isotwas::p_screen(P)) gene = as.data.frame(gene) head(gene) ##              Gene     Screen.P ## 1 ENSG00000070831 0.0016636386 ## 2 ENSG00000162552 0.0008302377 ## 3 ENSG00000230068 0.0004539979 alpha1=.05 G = nrow(gene) gene$Screen.P.Adjusted = p.adjust(gene$Screen.P,method = 'fdr') R = length(unique(gene$Gene[gene$Screen.P.Adjusted < alpha1])) alpha2 = (R*alpha1)/G print(gene) ##              Gene     Screen.P Screen.P.Adjusted ## 1 ENSG00000070831 0.0016636386       0.001663639 ## 2 ENSG00000162552 0.0008302377       0.001245357 ## 3 ENSG00000230068 0.0004539979       0.001245357 isoform_new = as.data.frame(matrix(nrow = 0,                                    ncol = ncol(out_df)+2)) colnames(isoform_new) = c(colnames(out_df),'Screen.P','Confirmation.P') gene = gene[order(gene$Screen.P),] ttt = merge(out_df,             gene[,c('Gene','Screen.P',                     'Screen.P.Adjusted')],             by = 'Gene')    isoform_new = ttt %>%   group_by(Gene) %>%   summarise(Feature = Feature,             Confirmation.P = isotwas::p_confirm(P,alpha = alpha2)) ## `summarise()` has grouped output by 'Gene'. You can override using the ## `.groups` argument. isoform_new = merge(isoform_new,ttt,by=c('Gene','Feature')) isoform_new$Confirmation.P = ifelse(isoform_new$Screen.P.Adjusted < 0.05,                                     isoform_new$Confirmation.P,                                     1) isoform_new = isoform_new[,c('Gene','Feature','Z','P','permute.P',                              'topSNP','topSNP.P',                              'Screen.P','Screen.P.Adjusted','Confirmation.P')] print(isoform_new) ##               Gene         Feature         Z            P   permute.P ## 1  ENSG00000070831 ENST00000315554  1.268410 0.2046514827 1.000000000 ## 2  ENSG00000070831 ENST00000344548 -3.239210 0.0011986108 1.000000000 ## 3  ENSG00000070831 ENST00000400259  3.344840 0.0008232993 0.011988012 ## 4  ENSG00000070831 ENST00000498236 -2.906460 0.0036554386 1.000000000 ## 5  ENSG00000070831 ENST00000656825  3.268385 0.0010816323 1.000000000 ## 6  ENSG00000070831 ENST00000662562 -3.278162 0.0010448529 1.000000000 ## 7  ENSG00000070831 ENST00000667384  0.575199 0.5651567515 1.000000000 ## 8  ENSG00000162552 ENST00000290167 -3.441877 0.0005776926 0.041958042 ## 9  ENSG00000162552 ENST00000415567 -3.179540 0.0014750883 1.000000000 ## 10 ENSG00000230068 ENST00000431803 -3.506525 0.0004539979 0.007992008 ##        topSNP     topSNP.P     Screen.P Screen.P.Adjusted Confirmation.P ## 1  rs11582542 0.0003396706 0.0016636386       0.001663639   1.0000000000 ## 2   rs2143103 0.0004331767 0.0016636386       0.001663639   0.0062691173 ## 3  rs11582542 0.0003396706 0.0016636386       0.001663639   0.0049397958 ## 4  rs11582542 0.0003396706 0.0016636386       0.001663639   0.0109663157 ## 5  rs11582542 0.0003396706 0.0016636386       0.001663639   0.0062691173 ## 6   rs2143103 0.0004331767 0.0016636386       0.001663639   0.0062691173 ## 7  rs11582542 0.0003396706 0.0016636386       0.001663639   1.0000000000 ## 8  rs11582542 0.0003396706 0.0008302377       0.001245357   0.0005776926 ## 9  rs11582542 0.0003396706 0.0008302377       0.001245357   0.0014750883 ## 10 rs11582542 0.0003396706 0.0004539979       0.001245357   0.0000000000 print(subset(isoform_new,Screen.P.Adjusted < alpha1 &                Confirmation.P < alpha2 &                permute.P < 0.05)) ##               Gene         Feature         Z            P   permute.P ## 3  ENSG00000070831 ENST00000400259  3.344840 0.0008232993 0.011988012 ## 8  ENSG00000162552 ENST00000290167 -3.441877 0.0005776926 0.041958042 ## 10 ENSG00000230068 ENST00000431803 -3.506525 0.0004539979 0.007992008 ##        topSNP     topSNP.P     Screen.P Screen.P.Adjusted Confirmation.P ## 3  rs11582542 0.0003396706 0.0016636386       0.001663639   0.0049397958 ## 8  rs11582542 0.0003396706 0.0008302377       0.001245357   0.0005776926 ## 10 rs11582542 0.0003396706 0.0004539979       0.001245357   0.0000000000"},{"path":"https://bhattacharya-a-bt.github.io/isotwas/articles/stageassoc.html","id":"fine-mapping-overlapping-and-trait-associated-isoforms","dir":"Articles","previous_headings":"","what":"Fine-mapping overlapping and trait-associated isoforms","title":"Run isoTWAS associations","text":"Since two isoforms overlap likely share LD-linked SNPs predict isoform, can’t sure three isoforms likely carrying trait association signal. short, account correlations genetically-predicted portions expression isoforms, enumerate possible causal configurations, use Bayesian approach generate posterior inclusion probability (PIP) isoform. PIPs can used generate 90% credible set isoforms best explain trait association locus. See Mancuso et al’s manuscript gene-level fine-mapping intuition mathematical details. fine-mapping, longer need GWAS summary statistics. need: TWAS summary statistics (something looks like isoform_new), isoTWAS models, LD reference panel. , need make sure LD reference matrix contains SNPs models isoforms overlapping locus. -sample individual-level genotypes, recommend using 1000 Genomes. ease tutorial, compiled necessary LD matrix. First, annotate isoform location select significantly associated isoforms within 1 Mb one another. can obtain gene annotation following code: Next, select overlapping isoforms. Significant isoforms overlap within 1 Mb another significant isoform need fine-mapped. Now, aggregate models generate single table SNP--isoform weights SNPs predict overlapping isoforms. step generates data frame model.df includes SNPs isoTWAS models locus effect (non-zero otherwise) isoforms fine-mapping locus. Now, obtain LD matrix SNPs model.df$SNP Now, run fine-mapping process following steps: (1) compute correlation genetically-predicted expression isoforms, (2) enumerate causal configurations, (3) compute marginal likelihoods Bayes factors isoform, (4) compute posterior inclusion probabilities credible sets. can see, ENST00000431803 ENST00000290167 PIP = 1 90% credible set (in_cred_set column). Full scripts association testing genome-wide available .","code":"suppressPackageStartupMessages(require(biomaRt)) gene_names = unique(isoform_new$Gene) ensembl <- useEnsembl(biomart = \"ensembl\",                     dataset = \"hsapiens_gene_ensembl\",                     mirror = \"useast\") bm = getBM(attributes = c('ensembl_gene_id',                            'chromosome_name',                           'start_position',                           'end_position'),       filters = 'ensembl_gene_id',       values = gene_names,        mart = ensembl) colnames(bm) = c('Gene','Chromosome','Start','End') bm = data.frame(Gene = c('ENSG00000070831','ENSG00000162552','ENSG00000230068'),                 Chromosome = 1,                 Start = c(22052627,22117313,22059197),                 End = c(22101360,22143969,22064199)) isoform_new = merge(bm,isoform_new,by='Gene')  isoform_new = isoform_new[order(isoform_new$Chromosome,                                 isoform_new$Start,                                 decreasing = F),] isoform_sig = subset(isoform_new,                      Screen.P.Adjusted < alpha1 &                        Confirmation.P < alpha2 &                        permute.P < 0.05)  keep.isoform = c() if (nrow(isoform_sig) > 1){       for (i in 1:(nrow(isoform_sig)-1)){         if (isoform_sig$End[i] > isoform_sig$Start[i+1] - 1e6){           keep.isoform = unique(c(keep.isoform,                               c(isoform_sig$Feature[c(i,i+1)])))         }       }   } isoform_sig = subset(isoform_sig,Feature %in% keep.isoform) all.snps = c() omega = c() pos = c() gene = c() snp.chr = c()  ### COLLECT WEIGHTS FOR SNPS IN THE MODELS for (i in 1:nrow(isoform_sig)){   gene_in = isoform_sig$Gene[i]   model_in = readRDS(system.file(\"extdata\",                               paste0(gene_in,\"_isoTWAS.RDS\"),                               package = \"isotwas\"))   model_in = subset(model_in,                     Feature == isoform_sig$Feature[i])   Model = data.frame(SNP = model_in$SNP,                      Chromosome = model_in$Chromosome,                      Position = model_in$Position,                      Effect = model_in$Weight,                      A1 = model_in$ALT,                      A2 = model_in$REF)   Model = subset(Model,Effect!=0)   Model = Model[!duplicated(Model$SNP),]   all.snps = c(all.snps,                as.character(Model$SNP))   omega = c(omega,             as.numeric(Model$Effect))   gene = c(gene,            rep(isoform_sig$Feature[i],nrow(Model)))   snp.chr = c(snp.chr,               as.numeric(Model$Chromosome))   pos = c(pos,as.numeric(Model$Position)) }  tot.df = data.frame(SNP = all.snps,                     Gene = gene,                     Effect = omega,                     Chromosome = snp.chr)  model.df = as.data.frame(matrix(nrow = length(unique(all.snps)),                                 ncol = nrow(isoform_sig)+1)) colnames(model.df) = c('SNP',isoform_sig$Feature) model.df$SNP = as.character(unique(all.snps))  for (q in 1:nrow(isoform_sig)){   cur.tot.df = subset(tot.df,Gene == isoform_sig$Feature[q])   cur.tot.df$SNP = as.character(cur.tot.df$SNP)   for (i in 1:nrow(model.df)){     w = which(cur.tot.df$SNP == model.df$SNP[i])     model.df[i,q+1] = ifelse(length(w) != 0,                              cur.tot.df$Effect[w],                              0)   } }  model.df$Chromosome = 2 for (i in 1:nrow(model.df)){   rrr = subset(tot.df,SNP == model.df$SNP[i])   model.df$Chromosome[i] = rrr$Chromosome[1] }  head(model.df) ##          SNP ENST00000400259 ENST00000431803 ENST00000290167 Chromosome ## 1  rs1002480   -3.437902e-04    8.726253e-05               0          1 ## 2  rs1011380   -5.231286e-05    8.881914e-05               0          1 ## 3  rs1014986    7.976357e-05    1.177811e-03               0          1 ## 4 rs10157808    2.620658e-04    2.047407e-05               0          1 ## 5  rs1018102    4.699228e-05    1.019356e-04               0          1 ## 6 rs10218584   -6.270159e-05    3.580614e-06               0          1 V = readRDS(system.file(\"extdata\",                         \"test_LD_finemapping.RDS\",                         package = \"isotwas\")) V = V[model.df$SNP,model.df$SNP] Omega = Matrix::Matrix(as.matrix(model.df[,-c(1,ncol(model.df))])) zscores = isoform_sig$Z m = length(zscores)  ### COMPUTE LD BETWEEN TX ON THE GENETIC LEVEL wcor = isotwas::estimate_cor(as.matrix(Omega),                              as.matrix(V),                              intercept=T)[[1]] diag(wcor) = 1 wcor[is.na(wcor)] = 0  ### COMPUTE LD INTERCEPT BETWEEN ISOFRM ON THE GENETIC LEVEL swld = isotwas::estimate_cor(as.matrix(Omega),                              as.matrix(V),                              intercept=T)[[2]]          null_res = m * log(1 - 1e-3) marginal = m * log(1 - 1e-3) comb_list = list() for (n in 1:min(2,length(zscores))){   comb_list = c(comb_list,                 combn(1:length(zscores),n,simplify=F))   }  pips = rep(0,length(zscores))  ### COMPUTE BAYES FACTORS/LIKELIHOOD AT EACH CAUSAL CONFIG for (j in 1:length(comb_list)){   subset = comb_list[[j]]   local = isotwas::bayes_factor(zscores,                                 idx_set = subset,                                 wcor = wcor)      marginal = log(exp(local) + exp(marginal))   for (idx in subset){     if (pips[idx] == 0){       pips[idx] = local       } else {         pips[idx] = log(exp(pips[idx]) + exp(local))       }   }   }  pips = exp(pips - marginal) null_res = exp(null_res - marginal) isoform_sig$pip = pips isoform_sig = isoform_sig[order(isoform_sig$pip,decreasing = T),] npost = isoform_sig$pip/sum(isoform_sig$pip) csum = cumsum(npost) isoform_sig$in_cred_set = F  for (i in 1:nrow(isoform_sig)){   isoform_sig$in_cred_set[i] = T   if (i > 1){     if (csum[i] > .9 & csum[i-1] < .9){       isoform_sig$in_cred_set[i] = T       }     if (csum[i] < .9){       isoform_sig$in_cred_set[i] = T       }     if (csum[i] > .9 & csum[i-1] > .9){       isoform_sig$in_cred_set[i] = F     }   }   }  print(isoform_sig) ##               Gene Chromosome    Start      End         Feature         Z ## 3  ENSG00000070831          1 22052627 22101360 ENST00000400259  3.344840 ## 10 ENSG00000230068          1 22059197 22064199 ENST00000431803 -3.506525 ## 8  ENSG00000162552          1 22117313 22143969 ENST00000290167 -3.441877 ##               P   permute.P     topSNP     topSNP.P     Screen.P ## 3  0.0008232993 0.011988012 rs11582542 0.0003396706 0.0016636386 ## 10 0.0004539979 0.007992008 rs11582542 0.0003396706 0.0004539979 ## 8  0.0005776926 0.041958042 rs11582542 0.0003396706 0.0008302377 ##    Screen.P.Adjusted Confirmation.P          pip in_cred_set ## 3        0.001663639   0.0049397958 1.000000e+00        TRUE ## 10       0.001245357   0.0000000000 1.000000e+00        TRUE ## 8        0.001245357   0.0005776926 1.419146e-18       FALSE"},{"path":"https://bhattacharya-a-bt.github.io/isotwas/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Arjun Bhattacharya. Author, maintainer.","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Bhattacharya (2026). isotwas: Isoform-level transcriptome-wide association studies. R package version 2.0.0.","code":"@Manual{,   title = {isotwas: Isoform-level transcriptome-wide association studies},   author = {Arjun Bhattacharya},   year = {2026},   note = {R package version 2.0.0}, }"},{"path":"https://bhattacharya-a-bt.github.io/isotwas/index.html","id":"isotwas","dir":"","previous_headings":"","what":"Isoform-level transcriptome-wide association studies","title":"Isoform-level transcriptome-wide association studies","text":"Welcome isotwas, package facilitates isoform-level transcriptome wide association studies (TWAS). package contains models train multivariate predictive models isoform-level expression run isoform-level trait mapping identify genetic associations complex traits. install: devtools::install_github(\"bhattacharya--bt/isotwas\")","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/bayes_factor.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute Bayes factors for TWAS Z-scores — bayes_factor","title":"Compute Bayes factors for TWAS Z-scores — bayes_factor","text":"function runs modified version FOCUS's Bayes factor calculation","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/bayes_factor.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute Bayes factors for TWAS Z-scores — bayes_factor","text":"","code":"bayes_factor(   zscores,   idx_set,   wcor,   prior_chisq = 40,   prb = 0.001,   use_log = T )"},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/bayes_factor.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute Bayes factors for TWAS Z-scores — bayes_factor","text":"zscores numeric, vector Z-scores idx_set character, ids transcripts wcor numeric, correlation matrix estimate_cor prior_chisq numeric, prior chi-square mean prb numeric, prior causal configuration use_log logical, use log bayes factors","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/bayes_factor.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute Bayes factors for TWAS Z-scores — bayes_factor","text":"bayes factor vector","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/burdenTest.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute weighted burden test — burdenTest","title":"Compute weighted burden test — burdenTest","text":"function takes gene expression model (either legacy format new isotwas_model format) GWAS summary statistics carries weighted burden Z-test trait.","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/burdenTest.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute weighted burden test — burdenTest","text":"","code":"burdenTest(   mod,   ld,   gene,   sumStats,   chr = NULL,   pos = NULL,   a1,   a2,   a1_mod = \"ALT\",   a2_mod = \"REF\",   snpName = \"SNP\",   Z = NULL,   beta = NULL,   se = NULL,   featureName = \"Feature\",   R2cutoff = 0.01,   alpha = 2.5e-06,   nperms = 1000,   usePos = FALSE )"},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/burdenTest.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute weighted burden test — burdenTest","text":"mod Model given isoform. Can : - data.frame legacy format columns: Feature, SNP, Weight, R2, etc. - single transcript model isotwas_model$transcripts$<name> - isotwas_model object (use first transcript) ld matrix, ld reference matrix SNP names row/colnames gene character, gene name sumStats data frame, GWAS summary statistics chr character, colnames sumStats keeps chromosome pos character, colnames sumStats keeps position a1 character, colnames sumStats keeps ALT allele a2 character, colnames sumStats keeps REF allele a1_mod character, colnames model keeps ALT allele a2_mod character, colnames model keeps REF allele snpName character, colnames sumStats keeps SNP id Z character, colnames sumStats keeps Z score beta character, colnames sumStats keeps effect size se character, colnames sumStats keeps standard error featureName character, colname model keeps feature name R2cutoff numeric, predictive R2 cutoff alpha numeric, P-value threshold permutation testing nperms numeric, number permutations usePos logical, use SNP positions vs. SNP ids","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/burdenTest.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute weighted burden test — burdenTest","text":"data.frame results burden permutation tests","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/burdenTest_all.html","id":null,"dir":"Reference","previous_headings":"","what":"Run burden test on all transcripts in an isotwas_model — burdenTest_all","title":"Run burden test on all transcripts in an isotwas_model — burdenTest_all","text":"Convenience function run burdenTest transcripts isotwas_model isotwas_result object.","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/burdenTest_all.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run burden test on all transcripts in an isotwas_model — burdenTest_all","text":"","code":"burdenTest_all(   model,   ld,   gene,   sumStats,   chr = NULL,   pos = NULL,   a1,   a2,   snpName = \"SNP\",   Z = NULL,   beta = NULL,   se = NULL,   R2cutoff = 0.01,   alpha = 2.5e-06,   nperms = 1000,   usePos = FALSE,   verbose = FALSE )"},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/burdenTest_all.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run burden test on all transcripts in an isotwas_model — burdenTest_all","text":"model isotwas_model isotwas_result object ld matrix, ld reference matrix SNP names row/colnames gene character, gene name sumStats data frame, GWAS summary statistics chr character, colnames sumStats keeps chromosome pos character, colnames sumStats keeps position a1 character, colnames sumStats keeps ALT allele a2 character, colnames sumStats keeps REF allele snpName character, colnames sumStats keeps SNP id Z character, colnames sumStats keeps Z score beta character, colnames sumStats keeps effect size se character, colnames sumStats keeps standard error R2cutoff numeric, predictive R2 cutoff alpha numeric, P-value threshold permutation testing nperms numeric, number permutations usePos logical, use SNP positions vs. SNP ids verbose logical, print progress","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/burdenTest_all.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run burden test on all transcripts in an isotwas_model — burdenTest_all","text":"data.frame burden test results transcripts","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/cash-.isotwas_model.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract a transcript model from isotwas_model — $.isotwas_model","title":"Extract a transcript model from isotwas_model — $.isotwas_model","text":"Extract transcript model isotwas_model","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/cash-.isotwas_model.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract a transcript model from isotwas_model — $.isotwas_model","text":"","code":"# S3 method for class 'isotwas_model' x$name"},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/cash-.isotwas_model.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract a transcript model from isotwas_model — $.isotwas_model","text":"x isotwas_model object name Transcript name extract","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/compute_blup.html","id":null,"dir":"Reference","previous_headings":"","what":"Univariate BLUP on all columns — compute_blup","title":"Univariate BLUP on all columns — compute_blup","text":"function trains unvariate rrBLUP models individually isoform transcripts","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/compute_blup.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Univariate BLUP on all columns — compute_blup","text":"","code":"compute_blup(   X,   Y,   Omega,   scale = F,   nfolds = 5,   verbose,   par = F,   n.cores = NULL,   tx_names = NULL,   seed )"},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/compute_blup.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Univariate BLUP on all columns — compute_blup","text":"X matrix, design matrix SNP dosages Y matrix, matrix G isoform expression across columns Omega matrix, precision matrix Y scale logical, T/F scale Y Omega nfolds int, number CV folds verbose logical par logical, uses mclapply parallelize model fit n.cores int, number parallel cores tx_names vector, character vector tx names order columns Y seed int, random seed","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/compute_blup.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Univariate BLUP on all columns — compute_blup","text":"data frame elastic net, lasso, LMM based predictions","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/compute_curds_whey.html","id":null,"dir":"Reference","previous_headings":"","what":"Breiman and Friedman's curds and whey multivariate regression with CV — compute_curds_whey","title":"Breiman and Friedman's curds and whey multivariate regression with CV — compute_curds_whey","text":"function trains curds whey multivariate regression cross-validated results","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/compute_curds_whey.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Breiman and Friedman's curds and whey multivariate regression with CV — compute_curds_whey","text":"","code":"compute_curds_whey(   X,   Y,   family = \"gaussian\",   alpha = 0.5,   nfolds = 5,   verbose,   par = F,   n.cores = NULL,   tx_names = NULL,   seed )"},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/compute_curds_whey.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Breiman and Friedman's curds and whey multivariate regression with CV — compute_curds_whey","text":"X matrix, design matrix SNP dosages Y matrix, matrix G isoform expression across columns family character, glmnet glm family alpha numeric, elastic net mixing parameter nfolds int, number CV folds verbose logical par logical, uses mclapply parallelize model fit n.cores int, number parallel cores tx_names vector, character vector tx names - order columns Y seed int, random seed","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/compute_curds_whey.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Breiman and Friedman's curds and whey multivariate regression with CV — compute_curds_whey","text":"data frame elastic net, lasso, LMM based predictions","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/compute_finemap_regress.html","id":null,"dir":"Reference","previous_headings":"","what":"Fine-mapping and clustering SEs with SUR — compute_finemap_regress","title":"Fine-mapping and clustering SEs with SUR — compute_finemap_regress","text":"function feature selects SuSiE runs SUR cluster-robust SEs","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/compute_finemap_regress.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fine-mapping and clustering SEs with SUR — compute_finemap_regress","text":"","code":"compute_finemap_regress(   X,   Y,   Y.rep,   R,   id,   nfolds,   verbose = F,   tx_names = NULL,   coverage = 0.9,   seed )"},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/compute_finemap_regress.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fine-mapping and clustering SEs with SUR — compute_finemap_regress","text":"X matrix, design matrix SNP dosages Y matrix, matrix G mean isoform expression across columns Y.rep matrix, matrix G isoform expression replicates R int, number replicates id vector, vector sample ids showing rep id nfolds int, number folds verbose logical tx_names vector, character vector tx names - order columns Y coverage numeric, covarage credible sets seed int, random seed","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/compute_finemap_regress.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fine-mapping and clustering SEs with SUR — compute_finemap_regress","text":"isoTWAS model list","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/compute_fixed.html","id":null,"dir":"Reference","previous_headings":"","what":"Multivariate regression with covariance estimate — compute_fixed","title":"Multivariate regression with covariance estimate — compute_fixed","text":"function trains multivariate lasso given covariance estimate","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/compute_fixed.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Multivariate regression with covariance estimate — compute_fixed","text":"","code":"compute_fixed(X, Y, lam2, Omega, tol.in, maxit.in, silent)"},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/compute_fixed.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Multivariate regression with covariance estimate — compute_fixed","text":"X matrix, design matrix SNP dosages Y matrix, matrix G isoform expression across columns lam2 numeric, lambda penalty LASSO Omega matrix, precision matrix Y tol.numeric, tolerance objective difference maxit.int, maximum number iteractions silent logical","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/compute_fixed.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Multivariate regression with covariance estimate — compute_fixed","text":"list MRCE estimates","code":""},{"path":[]},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/compute_fixed_precomputed.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Multivariate regression with covariance estimate (precomputed matrices) — compute_fixed_precomputed","text":"","code":"compute_fixed_precomputed(   xtx,   xtyom,   tolmult,   n,   p,   q,   lam2,   Omega,   tol.in,   maxit.in,   silent,   B0 = NULL,   mx,   my )"},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/compute_fixed_precomputed.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Multivariate regression with covariance estimate (precomputed matrices) — compute_fixed_precomputed","text":"xtx matrix, precomputed crossprod(X) centering xtyom matrix, precomputed crossprod(X,Y) tolmultnumeric, precomputed sum(crossprod(Y)*Omega) tolerance scaling nint, number samples pint, number SNPs qint, number isoforms lam2numeric, lambda penalty LASSO Omegamatrix, precision matrix Y tol.innumeric, tolerance objective difference maxit.inint, maximum number iterations silentlogical B0matrix, initial coefficient matrix warm starts (NULL zeros) mxvector, precomputed column means X myvector, precomputed column means Y list MRCE estimates   Optimized version accepts precomputed XtX XtY*Omega matrices avoid redundant computation cross-validation loops.  internal","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/compute_isotwas.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute isoTWAS model for a set of isoforms/transcripts — compute_isotwas","title":"Compute isoTWAS model for a set of isoforms/transcripts — compute_isotwas","text":"function runs multivariate regression models set transcripts outputs best model based cross-validated R-squared.","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/compute_isotwas.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute isoTWAS model for a set of isoforms/transcripts — compute_isotwas","text":"","code":"compute_isotwas(   X,   Y,   gene_exp = NULL,   Y.rep,   R = NULL,   id,   omega_est = \"replicates\",   omega_nlambda = 10,   method = c(\"mrce_lasso\", \"multi_enet\", \"joinet\", \"spls\", \"sgl\", \"mtlasso\", \"stacking\",     \"graph_reg\", \"univariate\"),   similarity_matrix = NULL,   predict_nlambda = 20,   family = \"gaussian\",   scale = FALSE,   alpha = 0.5,   nfolds = 5,   verbose = TRUE,   par = FALSE,   n.cores = NULL,   tx_names = NULL,   seed = NULL,   run_all = TRUE,   return_all = FALSE,   tol.in = 0.001,   maxit.in = 1000 )"},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/compute_isotwas.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute isoTWAS model for a set of isoforms/transcripts — compute_isotwas","text":"X matrix, design matrix SNP dosages Y matrix, matrix G isoform expression across columns gene_exp vector, vector total gene expression Y.rep matrix, matrix G isoform expression replicates R int, number replicates id vector, vector sample ids showing rep id omega_est character, 'replicates' 'mean' use Y.rep Y omega_nlambda int, number omegas generate method character, vector methods use. Available methods: \"mrce_lasso\": MRCE lasso penalty \"multi_enet\": Multivariate elastic net \"joinet\": Joinet stacked elastic net \"spls\": Sparse partial least squares \"sgl\": Sparse group lasso \"mtlasso\": Multi-task lasso (L21 regularization) \"stacking\": Super learner stacking multiple methods \"graph_reg\": Graph-regularized regression (requires similarity_matrix) \"univariate\": Best univariate elastic net, BLUP, SuSiE similarity_matrix matrix, optional similarity matrix graph_reg method. Can created using similarity_from_gtf create_similarity_from_exons. NULL, graph_reg skipped. predict_nlambda int, number lambdas MRCE family character, glmnet family scale logical, T/F scale Y Omega alpha numeric, elastic net mixing parameter nfolds int, number CV folds verbose logical, print progress messages par logical, uses mclapply parallelize model fit n.cores int, number parallel cores tx_names vector, character vector tx names - order columns Y seed int, random seed run_all logical, run methods return_all logical, return R2 models? tol.numeric, tolerance objective difference maxit.int, maximum number iterations","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/compute_isotwas.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute isoTWAS model for a set of isoforms/transcripts — compute_isotwas","text":"optimal isoTWAS model","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/compute_mrce.html","id":null,"dir":"Reference","previous_headings":"","what":"Multivariate regression with covariance estimate — compute_mrce","title":"Multivariate regression with covariance estimate — compute_mrce","text":"function trains multivariate lasso given covariance estimate","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/compute_mrce.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Multivariate regression with covariance estimate — compute_mrce","text":"","code":"compute_mrce(   X,   Y,   lambda = NULL,   nlambda = 20,   Omega,   nfolds = 5,   tol.in,   maxit.in,   verbose,   seed,   parallel = FALSE,   n.cores = NULL )"},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/compute_mrce.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Multivariate regression with covariance estimate — compute_mrce","text":"X matrix, design matrix SNP dosages Y matrix, matrix G isoform expression across columns lambda vector, lambda penalty vector LASSO tune nlambda int, number lambda value parameter selection Omega matrix, precision matrix Y nfolds int, number CV folds tol.numeric, tolerance objective difference maxit.int, maximum number iteractions verbose logical seed int, random seed parallel logical, whether parallelize CV folds n.cores int, number cores parallelization","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/compute_mrce.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Multivariate regression with covariance estimate — compute_mrce","text":"CV MRCE fit","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/compute_omega.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute precision matrix between isoforms — compute_omega","title":"Compute precision matrix between isoforms — compute_omega","text":"function computes covariance precision matrix columns isoform matrix","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/compute_omega.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute precision matrix between isoforms — compute_omega","text":"","code":"compute_omega(   Y,   Y.rep,   R,   id,   method = c(\"replicates\", \"mean\"),   nlambda = 15,   verbose = F )"},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/compute_omega.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute precision matrix between isoforms — compute_omega","text":"Y matrix, matrix G mean isoform expression across columns Y.rep matrix, matrix G isoform expression replicates R int, number replicates id vector, vector sample ids showing rep id method character, use Y.rep Y nlambda int, number matrices produce terms sparsity verbose logical","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/compute_omega.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute precision matrix between isoforms — compute_omega","text":"covariance /precision matrix list huge form","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/compute_spring.html","id":null,"dir":"Reference","previous_headings":"","what":"Multivariate regression with covariance estimate using elastic net — compute_spring","title":"Multivariate regression with covariance estimate using elastic net — compute_spring","text":"function trains multivariate elastic-net given covariance estimate","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/compute_spring.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Multivariate regression with covariance estimate using elastic net — compute_spring","text":"","code":"compute_spring(   X,   Y,   Omega,   intercept = F,   normalize = T,   nfolds = 5,   tol.in,   maxit.in,   verbose = T,   par = F,   n.cores,   seed )"},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/compute_spring.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Multivariate regression with covariance estimate using elastic net — compute_spring","text":"X matrix, design matrix SNP dosages Y matrix, matrix G isoform expression across columns Omega matrix, precision matrix Y intercept logical, include intercept normalize logical, normalize X Y nfolds int, number CV folds tol.numeric, tolerance objective difference maxit.int, maximum number iterations verbose logical par logical, parallelize seed int, random seed ncores int, number cores","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/compute_spring.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Multivariate regression with covariance estimate using elastic net — compute_spring","text":"CV MRCE fit","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/conditional_test.html","id":null,"dir":"Reference","previous_headings":"","what":"Conditional gene-level test — conditional_test","title":"Conditional gene-level test — conditional_test","text":"function tests gene association trait conditional isoforms","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/conditional_test.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Conditional gene-level test — conditional_test","text":"","code":"conditional_test(w_gene, w_iso, ld, z, gene_name, tx_name)"},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/conditional_test.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Conditional gene-level test — conditional_test","text":"w_gene vector, weights gene w_iso matrix, weights significant isoforms ld matrix, LD matrix z vector, GWAS Z-scores gene_name character, gene name tx_name vector, character vector tx names order columns Y","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/conditional_test.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Conditional gene-level test — conditional_test","text":"data frame conditional Z-scores combinations tx","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/conditional_test_focus.html","id":null,"dir":"Reference","previous_headings":"","what":"Conditional gene-level test — conditional_test_focus","title":"Conditional gene-level test — conditional_test_focus","text":"function tests gene association trait conditional isoforms","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/conditional_test_focus.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Conditional gene-level test — conditional_test_focus","text":"","code":"conditional_test_focus(w_gene, w_iso, ld, z, gene_name, tx_name)"},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/conditional_test_focus.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Conditional gene-level test — conditional_test_focus","text":"w_gene vector, weights gene w_iso matrix, weights significant isoforms ld matrix, LD matrix z vector, GWAS Z-scores gene_name character, gene name tx_name vector, character vector tx names order columns Y","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/conditional_test_focus.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Conditional gene-level test — conditional_test_focus","text":"data frame conditional Z-scores combinations tx","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/convert_legacy_model.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert legacy model list to isotwas_model — convert_legacy_model","title":"Convert legacy model list to isotwas_model — convert_legacy_model","text":"Converts old list--lists format new isotwas_model class","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/convert_legacy_model.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert legacy model list to isotwas_model — convert_legacy_model","text":"","code":"convert_legacy_model(model_list, method, n_samples, n_snps)"},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/convert_legacy_model.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert legacy model list to isotwas_model — convert_legacy_model","text":"model_list List legacy format (list lists Transcript, Model, R2, P, Pred) method Character string identifying method n_samples Number samples n_snps Total number SNPs","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/convert_legacy_model.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert legacy model list to isotwas_model — convert_legacy_model","text":"isotwas_model object","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/convert_model.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert isotwas model list to tibble — convert_model","title":"Convert isotwas model list to tibble — convert_model","text":"function converts isotwas model returns tibble","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/convert_model.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert isotwas model list to tibble — convert_model","text":"","code":"convert_model(model, snp_annot = NULL, snp_var = NULL)"},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/convert_model.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert isotwas model list to tibble — convert_model","text":"model, isotwas model snp_annot, annotations SNPs, typically map obj bigsnpr snp_var, column name SNP marker id","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/convert_model.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert isotwas model list to tibble — convert_model","text":"tibble model","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/create_isotwas_model.html","id":null,"dir":"Reference","previous_headings":"","what":"isoTWAS Model Classes and Methods — create_isotwas_model","title":"isoTWAS Model Classes and Methods — create_isotwas_model","text":"S3 classes representing isoTWAS prediction model outputs intuitive structure accessor methods. Create isotwas_model object","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/create_isotwas_model.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"isoTWAS Model Classes and Methods — create_isotwas_model","text":"","code":"create_isotwas_model(method, transcripts, n_samples, n_snps)"},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/create_isotwas_model.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"isoTWAS Model Classes and Methods — create_isotwas_model","text":"method character, name prediction method transcripts named list transcript model results n_samples int, number samples used training n_snps int, total number SNPs input","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/create_isotwas_model.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"isoTWAS Model Classes and Methods — create_isotwas_model","text":"isotwas_model object","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/create_isotwas_result.html","id":null,"dir":"Reference","previous_headings":"","what":"Create an isotwas_result object — create_isotwas_result","title":"Create an isotwas_result object — create_isotwas_result","text":"Create isotwas_result object","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/create_isotwas_result.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create an isotwas_result object — create_isotwas_result","text":"","code":"create_isotwas_result(   best_models,   method_results = NULL,   comparison_df = NULL,   tx2gene = NULL )"},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/create_isotwas_result.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create an isotwas_result object — create_isotwas_result","text":"best_models Named list best models per transcript method_results List isotwas_model objects (one per method) comparison_df Data frame comparing methods tx2gene Transcript gene coefficients","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/create_isotwas_result.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create an isotwas_result object — create_isotwas_result","text":"isotwas_result object","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/create_similarity_from_exons.html","id":null,"dir":"Reference","previous_headings":"","what":"Create similarity matrix from shared exons — create_similarity_from_exons","title":"Create similarity matrix from shared exons — create_similarity_from_exons","text":"Helper function create isoform similarity matrix based shared exons. Uses Jaccard similarity: |∩ B| / |∪ B|","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/create_similarity_from_exons.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create similarity matrix from shared exons — create_similarity_from_exons","text":"","code":"create_similarity_from_exons(   exon_list,   method = c(\"jaccard\", \"overlap\", \"count\") )"},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/create_similarity_from_exons.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create similarity matrix from shared exons — create_similarity_from_exons","text":"exon_list named list element character vector exon IDs isoform. Names match isoform/transcript IDs. method character, similarity method: \"jaccard\" (default), \"overlap\", \"count\"","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/create_similarity_from_exons.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create similarity matrix from shared exons — create_similarity_from_exons","text":"symmetric similarity matrix","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/create_similarity_from_exons.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Create similarity matrix from shared exons — create_similarity_from_exons","text":"Methods: \"jaccard\": Jaccard index = |shared| / |union| \"overlap\": Overlap coefficient = |shared| / min(||, |B|) \"count\": Raw count shared exons","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/create_transcript_model.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a single transcript model entry — create_transcript_model","title":"Create a single transcript model entry — create_transcript_model","text":"Helper function create properly structured transcript model","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/create_transcript_model.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a single transcript model entry — create_transcript_model","text":"","code":"create_transcript_model(transcript_id, weights, r2, pvalue, predicted)"},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/create_transcript_model.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a single transcript model entry — create_transcript_model","text":"transcript_id character, transcript/isoform identifier weights tibble/data.frame SNP Weight columns r2 numeric, cross-validated R-squared pvalue numeric, p-value prediction correlation predicted numeric vector, cross-validated predictions","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/create_transcript_model.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create a single transcript model entry — create_transcript_model","text":"list representing single transcript model","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/curds_whey.html","id":null,"dir":"Reference","previous_headings":"","what":"Breiman and Friedman's curds and whey multivariate regression — curds_whey","title":"Breiman and Friedman's curds and whey multivariate regression — curds_whey","text":"function trains curds whey multivariate regression","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/curds_whey.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Breiman and Friedman's curds and whey multivariate regression — curds_whey","text":"","code":"curds_whey(   X,   Y,   family = \"gaussian\",   alpha = 0.5,   nfolds = 5,   verbose,   par = F,   n.cores = NULL,   tx_names = NULL )"},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/curds_whey.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Breiman and Friedman's curds and whey multivariate regression — curds_whey","text":"X matrix, design matrix SNP dosages Y matrix, matrix G isoform expression across columns family character, glmnet glm family alpha numeric, elastic net mixing parameter nfolds int, number CV folds verbose logical par logical, uses mclapply parallelize model fit n.cores int, number parallel cores tx_names vector, character vector tx names order columns Y","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/curds_whey.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Breiman and Friedman's curds and whey multivariate regression — curds_whey","text":"data frame elastic net, lasso, LMM based predictions","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/dot-combine_base_weights.html","id":null,"dir":"Reference","previous_headings":"","what":"Combine base model weights using stacking weights — .combine_base_weights","title":"Combine base model weights using stacking weights — .combine_base_weights","text":"Combine base model weights using stacking weights","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/dot-combine_base_weights.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Combine base model weights using stacking weights — .combine_base_weights","text":"","code":".combine_base_weights(   final_base_models,   stack_weights,   base_methods,   tx_names,   snp_names )"},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/dot-compute_exon_similarity.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute similarity between two sets of exons — .compute_exon_similarity","title":"Compute similarity between two sets of exons — .compute_exon_similarity","text":"Compute similarity two sets exons","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/dot-compute_exon_similarity.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute similarity between two sets of exons — .compute_exon_similarity","text":"","code":".compute_exon_similarity(exons_i, exons_j, method)"},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/dot-compute_lambda_max_sgl.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute lambda_max for Sparse Group LASSO — .compute_lambda_max_sgl","title":"Compute lambda_max for Sparse Group LASSO — .compute_lambda_max_sgl","text":"Compute lambda_max Sparse Group LASSO","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/dot-compute_lambda_max_sgl.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute lambda_max for Sparse Group LASSO — .compute_lambda_max_sgl","text":"","code":".compute_lambda_max_sgl(X, Y, alpha)"},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/dot-compute_laplacian.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute graph Laplacian from similarity matrix — .compute_laplacian","title":"Compute graph Laplacian from similarity matrix — .compute_laplacian","text":"Compute graph Laplacian similarity matrix","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/dot-compute_laplacian.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute graph Laplacian from similarity matrix — .compute_laplacian","text":"","code":".compute_laplacian(S, normalize = FALSE)"},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/dot-compute_laplacian.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute graph Laplacian from similarity matrix — .compute_laplacian","text":"S similarity matrix (symmetric, non-negative) normalize logical, compute normalized Laplacian","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/dot-compute_laplacian.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute graph Laplacian from similarity matrix — .compute_laplacian","text":"Laplacian matrix","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/dot-convert_model_for_burden.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert model to legacy format for burden test — .convert_model_for_burden","title":"Convert model to legacy format for burden test — .convert_model_for_burden","text":"Internal function convert isotwas_model transcript model data.frame format expected burdenTest","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/dot-convert_model_for_burden.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert model to legacy format for burden test — .convert_model_for_burden","text":"","code":".convert_model_for_burden(mod, featureName = \"Feature\")"},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/dot-convert_model_for_burden.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert model to legacy format for burden test — .convert_model_for_burden","text":"mod Model object (various formats supported) featureName Column name feature/transcript ID","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/dot-convert_model_for_burden.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert model to legacy format for burden test — .convert_model_for_burden","text":"data.frame legacy format","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/dot-find_gene_in_gtf.html","id":null,"dir":"Reference","previous_headings":"","what":"Find gene in GTF with flexible matching — .find_gene_in_gtf","title":"Find gene in GTF with flexible matching — .find_gene_in_gtf","text":"Find gene GTF flexible matching","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/dot-find_gene_in_gtf.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Find gene in GTF with flexible matching — .find_gene_in_gtf","text":"","code":".find_gene_in_gtf(gtf, target_gene)"},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/dot-fit_base_method_coef.html","id":null,"dir":"Reference","previous_headings":"","what":"Get coefficients from base method using pre-computed hyperparameters — .fit_base_method_coef","title":"Get coefficients from base method using pre-computed hyperparameters — .fit_base_method_coef","text":"Get coefficients base method using pre-computed hyperparameters","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/dot-fit_base_method_coef.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get coefficients from base method using pre-computed hyperparameters — .fit_base_method_coef","text":"","code":".fit_base_method_coef(method, X, Y, params, seed)"},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/dot-fit_base_method_fast.html","id":null,"dir":"Reference","previous_headings":"","what":"Fast base method fitting using pre-computed hyperparameters — .fit_base_method_fast","title":"Fast base method fitting using pre-computed hyperparameters — .fit_base_method_fast","text":"Fast base method fitting using pre-computed hyperparameters","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/dot-fit_base_method_fast.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fast base method fitting using pre-computed hyperparameters — .fit_base_method_fast","text":"","code":".fit_base_method_fast(method, X_train, Y_train, X_test, params, seed)"},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/dot-fit_graph_reg.html","id":null,"dir":"Reference","previous_headings":"","what":"Fit graph-regularized elastic net using coordinate descent — .fit_graph_reg","title":"Fit graph-regularized elastic net using coordinate descent — .fit_graph_reg","text":"Solves: min (1/2n)||Y - XB||²_F + λ₁α||B||₁ + λ₁(1-α)/2||B||²_F + λ_g/2 tr(B'BL)","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/dot-fit_graph_reg.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fit graph-regularized elastic net using coordinate descent — .fit_graph_reg","text":"","code":".fit_graph_reg(   X,   Y,   L,   lambda1,   lambda_graph,   alpha,   B_init = NULL,   max_iter = 500,   tol = 1e-04 )"},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/dot-fit_mtl_l21.html","id":null,"dir":"Reference","previous_headings":"","what":"Fit L21-penalized multi-task regression via block coordinate descent — .fit_mtl_l21","title":"Fit L21-penalized multi-task regression via block coordinate descent — .fit_mtl_l21","text":"Fit L21-penalized multi-task regression via block coordinate descent","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/dot-fit_mtl_l21.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fit L21-penalized multi-task regression via block coordinate descent — .fit_mtl_l21","text":"","code":".fit_mtl_l21(   X,   Y,   lambda,   XtX_diag = NULL,   XtY = NULL,   W_init = NULL,   max_iter = 500,   tol = 1e-04 )"},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/dot-fit_sgl.html","id":null,"dir":"Reference","previous_headings":"","what":"Fit Sparse Group LASSO using coordinate descent — .fit_sgl","title":"Fit Sparse Group LASSO using coordinate descent — .fit_sgl","text":"Fit Sparse Group LASSO using coordinate descent","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/dot-fit_sgl.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fit Sparse Group LASSO using coordinate descent — .fit_sgl","text":"","code":".fit_sgl(X, Y, lambda, alpha, B_init = NULL, max_iter = 500, tol = 1e-04)"},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/dot-mtlasso_fast.html","id":null,"dir":"Reference","previous_headings":"","what":"Fast Multi-Task LASSO with L21 penalty — .mtlasso_fast","title":"Fast Multi-Task LASSO with L21 penalty — .mtlasso_fast","text":"Custom implementation optimized case tasks share X. Uses block coordinate descent group soft-thresholding.","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/dot-mtlasso_fast.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fast Multi-Task LASSO with L21 penalty — .mtlasso_fast","text":"","code":".mtlasso_fast(   X,   Y,   lambda = NULL,   lambda_seq = NULL,   nlambda = 20,   lambda_min_ratio = 0.01,   nfolds = 5,   standardize = FALSE,   verbose = FALSE,   seed = 123,   par = FALSE,   n.cores = 1 )"},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/dot-mtlasso_rmtl.html","id":null,"dir":"Reference","previous_headings":"","what":"RMTL backend for Multi-Task LASSO — .mtlasso_rmtl","title":"RMTL backend for Multi-Task LASSO — .mtlasso_rmtl","text":"Uses RMTL package. Slower supports Trace Lasso regularization.","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/dot-mtlasso_rmtl.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"RMTL backend for Multi-Task LASSO — .mtlasso_rmtl","text":"","code":".mtlasso_rmtl(   X,   Y,   regularization = \"L21\",   Lam1_seq = NULL,   Lam2 = 0,   nfolds = 5,   verbose = FALSE,   seed = 123,   par = FALSE,   n.cores = 1 )"},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/dot-nnls_weights_fast.html","id":null,"dir":"Reference","previous_headings":"","what":"Fast non-negative least squares for stacking weights — .nnls_weights_fast","title":"Fast non-negative least squares for stacking weights — .nnls_weights_fast","text":"Fast non-negative least squares stacking weights","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/dot-nnls_weights_fast.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fast non-negative least squares for stacking weights — .nnls_weights_fast","text":"","code":".nnls_weights_fast(Z, y)"},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/dot-precompute_hyperparams.html","id":null,"dir":"Reference","previous_headings":"","what":"Precompute optimal hyperparameters for each method — .precompute_hyperparams","title":"Precompute optimal hyperparameters for each method — .precompute_hyperparams","text":"Precompute optimal hyperparameters method","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/dot-precompute_hyperparams.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Precompute optimal hyperparameters for each method — .precompute_hyperparams","text":"","code":".precompute_hyperparams(X, Y, base_methods, seed)"},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/estimate_cor.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute correlation for fine-mapping — estimate_cor","title":"Compute correlation for fine-mapping — estimate_cor","text":"function runs modified version FOCUS's correlation matrix estimation","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/estimate_cor.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute correlation for fine-mapping — estimate_cor","text":"","code":"estimate_cor(wmat, ldmat, intercept = F)"},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/estimate_cor.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute correlation for fine-mapping — estimate_cor","text":"wmat numeric, matrix weights ldmat numeric, matrix linkage disequilibrium intercept logical, T/F including intercept","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/estimate_cor.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute correlation for fine-mapping — estimate_cor","text":"correlation GReX /without intercept","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/finemap_regress.html","id":null,"dir":"Reference","previous_headings":"","what":"Fine-mapping and clustering SEs with SUR — finemap_regress","title":"Fine-mapping and clustering SEs with SUR — finemap_regress","text":"function feature selects SuSiE runs SUR cluster-robust SEs","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/finemap_regress.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fine-mapping and clustering SEs with SUR — finemap_regress","text":"","code":"finemap_regress(   X,   Y,   Y.rep,   R,   id,   verbose = F,   tx_names = NULL,   coverage = 0.9 )"},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/finemap_regress.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fine-mapping and clustering SEs with SUR — finemap_regress","text":"X matrix, design matrix SNP dosages Y matrix, matrix G mean isoform expression across columns Y.rep matrix, matrix G isoform expression replicates R int, number replicates id vector, vector sample ids showing rep id verbose logical tx_names vector, character vector tx names order columns Y coverage numeric, coverage credible set","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/finemap_regress.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fine-mapping and clustering SEs with SUR — finemap_regress","text":"data frame elastic net, lasso, LMM based predictions","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/get_best_isotwas.html","id":null,"dir":"Reference","previous_headings":"","what":"Select best model per transcript from multiple isotwas_model objects — get_best_isotwas","title":"Select best model per transcript from multiple isotwas_model objects — get_best_isotwas","text":"Select best model per transcript multiple isotwas_model objects","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/get_best_isotwas.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Select best model per transcript from multiple isotwas_model objects — get_best_isotwas","text":"","code":"get_best_isotwas(model_list, G)"},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/get_best_isotwas.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Select best model per transcript from multiple isotwas_model objects — get_best_isotwas","text":"model_list List isotwas_model objects G Number transcripts","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/get_best_isotwas.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Select best model per transcript from multiple isotwas_model objects — get_best_isotwas","text":"isotwas_model best model per transcript","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/get_prediction_matrix.html","id":null,"dir":"Reference","previous_headings":"","what":"Get predicted values as a matrix — get_prediction_matrix","title":"Get predicted values as a matrix — get_prediction_matrix","text":"Get predicted values matrix","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/get_prediction_matrix.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get predicted values as a matrix — get_prediction_matrix","text":"","code":"get_prediction_matrix(model)"},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/get_prediction_matrix.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get predicted values as a matrix — get_prediction_matrix","text":"model isotwas_model object","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/get_prediction_matrix.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get predicted values as a matrix — get_prediction_matrix","text":"matrix samples rows transcripts columns","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/get_resid.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute residuals for Z-scores — get_resid","title":"Compute residuals for Z-scores — get_resid","text":"function runs modified version FOCUS's residual calculation","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/get_resid.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute residuals for Z-scores — get_resid","text":"","code":"get_resid(zscores, swld, wcor)"},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/get_resid.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute residuals for Z-scores — get_resid","text":"zscores numeric, vector Z-scores swld numeric, LD matrix wcor numeric, correlation matrix estimate_cor","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/get_resid.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute residuals for Z-scores — get_resid","text":"residuals residualized Z-scores","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/get_weight_matrix.html","id":null,"dir":"Reference","previous_headings":"","what":"Get weights for all transcripts as a matrix — get_weight_matrix","title":"Get weights for all transcripts as a matrix — get_weight_matrix","text":"Get weights transcripts matrix","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/get_weight_matrix.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get weights for all transcripts as a matrix — get_weight_matrix","text":"","code":"get_weight_matrix(model, snps = NULL)"},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/get_weight_matrix.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get weights for all transcripts as a matrix — get_weight_matrix","text":"model isotwas_model object snps Optional character vector SNP names include (default: )","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/get_weight_matrix.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get weights for all transcripts as a matrix — get_weight_matrix","text":"matrix SNPs rows transcripts columns","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/multivariate_elasticnet.html","id":null,"dir":"Reference","previous_headings":"","what":"Multivariate elastic net on all columns with row-wise penalty — multivariate_elasticnet","title":"Multivariate elastic net on all columns with row-wise penalty — multivariate_elasticnet","text":"function trains multivariate elastic net models isoform transcripts jointly","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/multivariate_elasticnet.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Multivariate elastic net on all columns with row-wise penalty — multivariate_elasticnet","text":"","code":"multivariate_elasticnet(   X,   Y,   Omega,   scale = F,   alpha = 0.5,   nfolds = 5,   verbose = T,   par = F,   n.cores = NULL,   tx_names = NULL,   seed )"},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/multivariate_elasticnet.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Multivariate elastic net on all columns with row-wise penalty — multivariate_elasticnet","text":"X matrix, design matrix SNP dosages Y matrix, matrix G isoform expression across columns Omega matrix, precision matrix Y scale logical, T/F scale Y Omega alpha numeric, elastic net mixing parameter nfolds int, number CV folds verbose logical par logical, uses mclapply parallelize model fit n.cores int, number parallel cores tx_names vector, character vector tx names order columns Y seed int, random seed","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/multivariate_elasticnet.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Multivariate elastic net on all columns with row-wise penalty — multivariate_elasticnet","text":"data frame elastic net, lasso, LMM based predictions","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/multivariate_graph_reg.html","id":null,"dir":"Reference","previous_headings":"","what":"Multivariate Graph-Regularized Regression — multivariate_graph_reg","title":"Multivariate Graph-Regularized Regression — multivariate_graph_reg","text":"Fits multivariate regression model graph Laplacian regularization. method encourages isoforms similar (e.g., share exons) similar prediction weight vectors.","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/multivariate_graph_reg.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Multivariate Graph-Regularized Regression — multivariate_graph_reg","text":"","code":"multivariate_graph_reg(   X,   Y,   similarity_matrix = NULL,   lambda1 = NULL,   lambda_graph = NULL,   alpha = 0.5,   nlambda = 15,   nlambda_graph = 5,   lambda_graph_seq = NULL,   normalize_laplacian = FALSE,   nfolds = 5,   standardize = FALSE,   verbose = FALSE,   seed = 123,   par = FALSE,   n.cores = NULL )"},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/multivariate_graph_reg.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Multivariate Graph-Regularized Regression — multivariate_graph_reg","text":"X matrix, design matrix SNP dosages (n x p) Y matrix, matrix isoform expression across columns (n x q) similarity_matrix matrix, q x q symmetric matrix pairwise isoform similarities (e.g., Jaccard index shared exons). Values >= 0. NULL, uses identity (graph regularization, equivalent lasso). lambda1 numeric NULL, L1 penalty parameter. NULL, selected CV. lambda_graph numeric NULL, graph penalty parameter. NULL, selected CV. alpha numeric, elastic net mixing (0 = ridge, 1 = lasso). Default 0.5. nlambda int, number lambda1 values try CV nlambda_graph int, number lambda_graph values try CV lambda_graph_seq numeric vector, specific lambda_graph values try. NULL, auto-generated. normalize_laplacian logical, use normalized Laplacian. Default FALSE. nfolds int, number CV folds standardize logical, standardize X fitting verbose logical, print progress seed int, random seed par logical, use parallel processing. Default FALSE. n.cores int, number cores parallel processing. Default NULL (auto-detect).","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/multivariate_graph_reg.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Multivariate Graph-Regularized Regression — multivariate_graph_reg","text":"isotwas_model object containing: transcripts: list transcript_model objects best_lambda1: optimal L1 penalty best_lambda_graph: optimal graph penalty laplacian: Laplacian matrix used","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/multivariate_graph_reg.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Multivariate Graph-Regularized Regression — multivariate_graph_reg","text":"optimization problem : $$\\min_B \\frac{1}{2n}||Y - XB||_F^2 + \\lambda_1 ||B||_1 + \\frac{\\lambda_g}{2} \\text{tr}(B^T B L)$$ L graph Laplacian computed similarity matrix: $$L = D - S$$ D degree matrix (diagonal row sums S). graph penalty encourages isoforms high similarity similar coefficient vectors across SNPs. similarity matrix encodes prior knowledge isoform relationships. isoform-level TWAS, typically derived shared exon structure: isoforms sharing exons expected similar cis-regulatory effects, share genetic signal. par=TRUE, cross-validation parallelized (lambda_graph, fold) combinations, providing nlambda_graph * nfolds parallel tasks.","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/multivariate_joinet.html","id":null,"dir":"Reference","previous_headings":"","what":"Multivariate stacked elastic net on all columns using joinet — multivariate_joinet","title":"Multivariate stacked elastic net on all columns using joinet — multivariate_joinet","text":"function trains multivariate elastic net models isoform transcripts jointly","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/multivariate_joinet.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Multivariate stacked elastic net on all columns using joinet — multivariate_joinet","text":"","code":"multivariate_joinet(   X,   Y,   Omega,   scale = F,   alpha = 0.5,   nfolds = 5,   verbose = T,   par = F,   n.cores = NULL,   tx_names = NULL,   seed )"},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/multivariate_joinet.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Multivariate stacked elastic net on all columns using joinet — multivariate_joinet","text":"X matrix, design matrix SNP dosages Y matrix, matrix G isoform expression across columns Omega matrix, precision matrix Y scale logical, T/F scale Y Omega alpha numeric, elastic net mixing parameter nfolds int, number CV folds verbose logical par logical, uses mclapply parallelize model fit n.cores int, number parallel cores tx_names vector, character vector tx names order columns Y seed int, random seed","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/multivariate_joinet.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Multivariate stacked elastic net on all columns using joinet — multivariate_joinet","text":"data frame elastic net, lasso, LMM based predictions","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/multivariate_mmbr.html","id":null,"dir":"Reference","previous_headings":"","what":"Multivariate SuSiE model — multivariate_mmbr","title":"Multivariate SuSiE model — multivariate_mmbr","text":"function trains multivariate SuSiE isoform transcripts jointly","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/multivariate_mmbr.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Multivariate SuSiE model — multivariate_mmbr","text":"","code":"multivariate_mmbr(   X,   Y,   nfolds = 5,   verbose = T,   tx_names = NULL,   L = 10,   par,   n.cores,   seed )"},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/multivariate_mmbr.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Multivariate SuSiE model — multivariate_mmbr","text":"X matrix, design matrix SNP dosages Y matrix, matrix G isoform expression across columns nfolds int, number CV folds verbose logical tx_names vector, character vector tx names order columns Y L int, number single effects par logical, uses mclapply parallelize model fit n.cores int, number parallel cores seed int, random seed","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/multivariate_mmbr.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Multivariate SuSiE model — multivariate_mmbr","text":"data frame mvSuSiE weights","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/multivariate_mrmash.html","id":null,"dir":"Reference","previous_headings":"","what":"Multivariate MrMash model — multivariate_mrmash","title":"Multivariate MrMash model — multivariate_mrmash","text":"function trains multivariate mr mash isoform transcripts jointly","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/multivariate_mrmash.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Multivariate MrMash model — multivariate_mrmash","text":"","code":"multivariate_mrmash(   X,   Y,   nfolds = 5,   verbose = T,   tx_names = NULL,   par,   n.cores,   seed )"},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/multivariate_mrmash.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Multivariate MrMash model — multivariate_mrmash","text":"X matrix, design matrix SNP dosages Y matrix, matrix G isoform expression across columns nfolds int, number CV folds verbose logical tx_names vector, character vector tx names order columns Y par logical, uses mclapply parallelize model fit n.cores int, number parallel cores seed int, random seed","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/multivariate_mrmash.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Multivariate MrMash model — multivariate_mrmash","text":"mrmash models","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/multivariate_mtlasso.html","id":null,"dir":"Reference","previous_headings":"","what":"Multivariate Multi-Task LASSO — multivariate_mtlasso","title":"Multivariate Multi-Task LASSO — multivariate_mtlasso","text":"Fits multi-task LASSO model multivariate isoform prediction. method encourages joint feature selection across isoforms using L21 regularization (row sparsity coefficient matrix).","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/multivariate_mtlasso.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Multivariate Multi-Task LASSO — multivariate_mtlasso","text":"","code":"multivariate_mtlasso(   X,   Y,   regularization = c(\"L21\", \"Trace\", \"Lasso\"),   lambda = NULL,   lambda_seq = NULL,   nlambda = 20,   lambda_min_ratio = 0.01,   Lam2 = 0,   nfolds = 5,   standardize = FALSE,   verbose = FALSE,   seed = 123,   par = FALSE,   n.cores = 1,   backend = c(\"fast\", \"rmtl\") )"},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/multivariate_mtlasso.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Multivariate Multi-Task LASSO — multivariate_mtlasso","text":"X matrix, design matrix SNP dosages (n x p) Y matrix, matrix isoform expression across columns (n x q) regularization character, type multi-task regularization: \"L21\": L2,1 norm (row sparsity) - SNPs selected across isoforms \"Trace\": trace norm (low-rank) - isoforms share latent structure (RMTL ) \"Lasso\": standard lasso applied jointly (RMTL ) lambda numeric NULL, regularization parameter. NULL, selected CV. lambda_seq numeric vector, sequence lambda values try CV. NULL, automatically generates sequence. nlambda int, number lambda values lambda_seq NULL lambda_min_ratio numeric, ratio min max lambda Lam2 numeric, ridge penalty parameter (RMTL backend). Default 0. nfolds int, number CV folds standardize logical, standardize X fitting. Default FALSE. verbose logical, print progress seed int, random seed par logical, use parallel processing CV folds n.cores int, number cores parallel processing backend character, implementation use: \"fast\": Custom fast implementation optimized shared X (default) \"rmtl\": Use RMTL package (slower, supports Trace/Lasso regularization)","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/multivariate_mtlasso.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Multivariate Multi-Task LASSO — multivariate_mtlasso","text":"isotwas_model object containing: transcripts: list transcript_model objects weights, R2, pvalues best_lambda: optimal lambda CV regularization: type regularization used","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/multivariate_mtlasso.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Multivariate Multi-Task LASSO — multivariate_mtlasso","text":"L21 penalty enforces SNPs selected excluded across isoforms, appropriate SNPs expected shared effects multiple isoforms gene. L21 regularization solves: $$\\min_W \\frac{1}{2n}||Y - XW||_F^2 + \\lambda ||W||_{2,1}$$ \\(||W||_{2,1} = \\sum_j ||W_j||_2\\) sum L2 norms rows, encouraging entire rows (SNPs) zero non-zero together. fast backend exploits shared X structure precomputing X'X , making much faster general-purpose MTL solvers.","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/multivariate_mtlasso_cv.html","id":null,"dir":"Reference","previous_headings":"","what":"Multivariate Multi-Task LASSO with multiple regularization comparison — multivariate_mtlasso_cv","title":"Multivariate Multi-Task LASSO with multiple regularization comparison — multivariate_mtlasso_cv","text":"Runs MTLASSO different regularization types returns best model based cross-validated MSE.","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/multivariate_mtlasso_cv.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Multivariate Multi-Task LASSO with multiple regularization comparison — multivariate_mtlasso_cv","text":"","code":"multivariate_mtlasso_cv(   X,   Y,   regularizations = c(\"L21\", \"Trace\", \"Lasso\"),   nfolds = 5,   verbose = FALSE,   seed = 123,   par = FALSE,   n.cores = 1 )"},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/multivariate_mtlasso_cv.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Multivariate Multi-Task LASSO with multiple regularization comparison — multivariate_mtlasso_cv","text":"X matrix, design matrix SNP dosages (n x p) Y matrix, matrix isoform expression across columns (n x q) regularizations character vector, regularization types compare nfolds int, number CV folds verbose logical, print progress seed int, random seed par logical, use parallel processing CV folds n.cores int, number cores parallel processing","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/multivariate_mtlasso_cv.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Multivariate Multi-Task LASSO with multiple regularization comparison — multivariate_mtlasso_cv","text":"isotwas_model object best regularization","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/multivariate_sgl.html","id":null,"dir":"Reference","previous_headings":"","what":"Multivariate Sparse Group LASSO — multivariate_sgl","title":"Multivariate Sparse Group LASSO — multivariate_sgl","text":"Fits sparse group LASSO model multivariate isoform prediction. method encourages : - Group-level sparsity: SNPs tend affect multiple isoforms (shared effects) - Within-group sparsity: isoform-specific effects","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/multivariate_sgl.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Multivariate Sparse Group LASSO — multivariate_sgl","text":"","code":"multivariate_sgl(   X,   Y,   alpha = 0.5,   nlambda = 20,   lambda_min_ratio = 0.01,   nfolds = 5,   standardize = FALSE,   verbose = FALSE,   seed = 123,   par = FALSE,   n.cores = 1 )"},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/multivariate_sgl.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Multivariate Sparse Group LASSO — multivariate_sgl","text":"X matrix, design matrix SNP dosages Y matrix, matrix G isoform expression across columns alpha numeric, mixing parameter group individual sparsity (0-1) alpha=1 pure LASSO, alpha=0 pure group LASSO nlambda int, number lambda values try lambda_min_ratio numeric, ratio lambda_min lambda_max nfolds int, number CV folds standardize logical, standardize X fitting verbose logical seed int, random seed par logical, use parallel processing CV folds n.cores int, number cores parallel processing","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/multivariate_sgl.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Multivariate Sparse Group LASSO — multivariate_sgl","text":"isotwas_model object","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/multivariate_sgl.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Multivariate Sparse Group LASSO — multivariate_sgl","text":"penalty : alpha * ||B||_1 + (1-alpha) * sum_j ||B_j||_2 B_j j-th row B (effects SNP j across isoforms)","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/multivariate_sgl_cv.html","id":null,"dir":"Reference","previous_headings":"","what":"Cross-validated Sparse Group LASSO with automatic alpha selection — multivariate_sgl_cv","title":"Cross-validated Sparse Group LASSO with automatic alpha selection — multivariate_sgl_cv","text":"Runs SGL grid alpha values selects best combination alpha lambda via cross-validation.","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/multivariate_sgl_cv.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Cross-validated Sparse Group LASSO with automatic alpha selection — multivariate_sgl_cv","text":"","code":"multivariate_sgl_cv(   X,   Y,   alpha_seq = c(0.1, 0.5, 0.9),   nlambda = 15,   nfolds = 5,   verbose = FALSE,   seed = 123,   par = FALSE,   n.cores = 1 )"},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/multivariate_sgl_cv.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Cross-validated Sparse Group LASSO with automatic alpha selection — multivariate_sgl_cv","text":"X matrix, design matrix SNP dosages Y matrix, matrix G isoform expression across columns alpha_seq numeric vector, sequence alpha values try nlambda int, number lambda values per alpha nfolds int, number CV folds verbose logical seed int, random seed par logical, use parallel processing CV folds n.cores int, number cores parallel processing","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/multivariate_sgl_cv.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Cross-validated Sparse Group LASSO with automatic alpha selection — multivariate_sgl_cv","text":"isotwas_model object best alpha lambda","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/multivariate_spls.html","id":null,"dir":"Reference","previous_headings":"","what":"Multivariate sparse partial least squares — multivariate_spls","title":"Multivariate sparse partial least squares — multivariate_spls","text":"function trains multivariate spls isoform transcripts jointly","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/multivariate_spls.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Multivariate sparse partial least squares — multivariate_spls","text":"","code":"multivariate_spls(   X,   Y,   nfolds = 5,   verbose = T,   tx_names = NULL,   par,   n.cores,   seed )"},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/multivariate_spls.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Multivariate sparse partial least squares — multivariate_spls","text":"X matrix, design matrix SNP dosages Y matrix, matrix G isoform expression across columns nfolds int, number CV folds verbose logical tx_names vector, character vector tx names order columns Y par logical, uses mclapply parallelize model fit n.cores int, number parallel cores seed int, random seed","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/multivariate_spls.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Multivariate sparse partial least squares — multivariate_spls","text":"spls models","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/multivariate_stacking.html","id":null,"dir":"Reference","previous_headings":"","what":"Multivariate Super Learner Stacking — multivariate_stacking","title":"Multivariate Super Learner Stacking — multivariate_stacking","text":"Combines predictions multiple base methods using optimal weights learned via cross-validation. meta-learner approach typically improves upon best single method.","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/multivariate_stacking.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Multivariate Super Learner Stacking — multivariate_stacking","text":"","code":"multivariate_stacking(   X,   Y,   Y.rep = NULL,   R = NULL,   id = NULL,   Omega = NULL,   base_methods = c(\"multi_enet\", \"univariate_enet\", \"ridge\", \"lasso\"),   nfolds_stack = 5,   verbose = FALSE,   seed = 123,   parallel = FALSE,   n.cores = 1 )"},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/multivariate_stacking.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Multivariate Super Learner Stacking — multivariate_stacking","text":"X matrix, design matrix SNP dosages Y matrix, matrix G isoform expression across columns Y.rep matrix, matrix G isoform expression replicates (optional) R int, number replicates (optional) id vector, vector sample ids (optional) Omega matrix, precision matrix Y (optional, computed provided) base_methods character vector, methods use base learners. Available: \"multi_enet\", \"univariate_enet\", \"ridge\", \"lasso\", \"spls\" nfolds_stack int, number CV folds stacking weights verbose logical seed int, random seed parallel logical, use parallel processing base methods n.cores int, number cores parallel processing","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/multivariate_stacking.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Multivariate Super Learner Stacking — multivariate_stacking","text":"isotwas_model object stacked predictions","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/p_confirm.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute confirmation P-value for one gene — p_confirm","title":"Compute confirmation P-value for one gene — p_confirm","text":"function runs modified version Shaffer's MSRB procedure control family-wise error rate given gene","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/p_confirm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute confirmation P-value for one gene — p_confirm","text":"","code":"p_confirm(p, alpha = 0.05)"},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/p_confirm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute confirmation P-value for one gene — p_confirm","text":"p numeric, vector TWAS P-values isoforms one gene alpha numeric, significance level","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/p_confirm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute confirmation P-value for one gene — p_confirm","text":"confirmation adjusted P-values isoforms one gene","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/p_screen.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute screening P-value for one gene — p_screen","title":"Compute screening P-value for one gene — p_screen","text":"function runs modified version P_ACT test hypothesis least one gene-transcript association","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/p_screen.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute screening P-value for one gene — p_screen","text":"","code":"p_screen(teststat, mode = \"P\")"},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/p_screen.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute screening P-value for one gene — p_screen","text":"teststat numeric, vector TWAS Z-scores P-values mode character, teststat Z-scores P-values?","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/p_screen.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute screening P-value for one gene — p_screen","text":"screen P-value one gene","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/print.isotwas_model.html","id":null,"dir":"Reference","previous_headings":"","what":"Print method for isotwas_model — print.isotwas_model","title":"Print method for isotwas_model — print.isotwas_model","text":"Print method isotwas_model","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/print.isotwas_model.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print method for isotwas_model — print.isotwas_model","text":"","code":"# S3 method for class 'isotwas_model' print(x, ...)"},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/print.isotwas_model.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print method for isotwas_model — print.isotwas_model","text":"x isotwas_model object ... Additional arguments (unused)","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/print.isotwas_result.html","id":null,"dir":"Reference","previous_headings":"","what":"Print method for isotwas_result — print.isotwas_result","title":"Print method for isotwas_result — print.isotwas_result","text":"Print method isotwas_result","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/print.isotwas_result.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print method for isotwas_result — print.isotwas_result","text":"","code":"# S3 method for class 'isotwas_result' print(x, ...)"},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/print.isotwas_result.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print method for isotwas_result — print.isotwas_result","text":"x isotwas_result object ... Additional arguments (unused)","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/similarity_from_gtf.html","id":null,"dir":"Reference","previous_headings":"","what":"Create Isoform Similarity Matrix from GTF — similarity_from_gtf","title":"Create Isoform Similarity Matrix from GTF — similarity_from_gtf","text":"Parses GTF file creates similarity matrix isoforms specified gene based shared exon structure. matrix can used multivariate_graph_reg graph-regularized prediction.","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/similarity_from_gtf.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create Isoform Similarity Matrix from GTF — similarity_from_gtf","text":"","code":"similarity_from_gtf(   gtf_path,   gene,   method = c(\"jaccard\", \"overlap_coef\", \"binary\"),   transcript_ids = NULL,   min_transcripts = 2,   verbose = TRUE )"},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/similarity_from_gtf.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create Isoform Similarity Matrix from GTF — similarity_from_gtf","text":"gtf_path character, path GTF file (can gzipped) gene character, gene name (HGNC symbol) Ensembl gene ID method character, similarity method: \"jaccard\": Jaccard index based exon overlap (default) \"overlap_coef\": Overlap coefficient = overlap / min(length_i, length_j) \"binary\": 1 overlap, 0 otherwise transcript_ids character vector, optional subset transcript IDs include. NULL, uses transcripts gene. min_transcripts int, minimum number transcripts required (default 2) verbose logical, print progress messages","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/similarity_from_gtf.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create Isoform Similarity Matrix from GTF — similarity_from_gtf","text":"list containing: similarity_matrix: symmetric matrix pairwise isoform similarities transcript_ids: character vector transcript IDs (matrix row/col names) gene_id: matched gene identifier n_transcripts: number transcripts n_exons: named vector exon counts per transcript","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/similarity_from_gtf.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Create Isoform Similarity Matrix from GTF — similarity_from_gtf","text":"function computes pairwise similarity isoforms based exon structure. Isoforms share exonic sequence considered similar, reflecting biological intuition likely share cis-regulatory effects. Jaccard similarity computed : $$J(,j) = \\frac{|overlap(exons_i, exons_j)|}{|union(exons_i, exons_j)|}$$ overlap union computed terms genomic base pairs.","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/similarity_from_gtf.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create Isoform Similarity Matrix from GTF — similarity_from_gtf","text":"","code":"if (FALSE) { # \\dontrun{ # Create similarity matrix for BRCA1 isoforms sim <- similarity_from_gtf(\"gencode.v45.annotation.gtf.gz\", \"BRCA1\")  # Use with graph-regularized prediction model <- multivariate_graph_reg(X, Y, similarity_matrix = sim$similarity_matrix) } # }"},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/sub-.isotwas_model.html","id":null,"dir":"Reference","previous_headings":"","what":"Subset isotwas_model by transcript name — [.isotwas_model","title":"Subset isotwas_model by transcript name — [.isotwas_model","text":"Subset isotwas_model transcript name","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/sub-.isotwas_model.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Subset isotwas_model by transcript name — [.isotwas_model","text":"","code":"# S3 method for class 'isotwas_model' x[i]"},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/sub-.isotwas_model.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Subset isotwas_model by transcript name — [.isotwas_model","text":"x isotwas_model object Transcript name(s) index","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/subset_similarity.html","id":null,"dir":"Reference","previous_headings":"","what":"Create similarity matrix for a subset of transcripts — subset_similarity","title":"Create similarity matrix for a subset of transcripts — subset_similarity","text":"Given pre-computed similarity result subset transcript IDs, returns corresponding submatrix. Useful Y matrix fewer transcripts full gene.","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/subset_similarity.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create similarity matrix for a subset of transcripts — subset_similarity","text":"","code":"subset_similarity(sim_result, transcript_ids, match_without_version = TRUE)"},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/subset_similarity.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create similarity matrix for a subset of transcripts — subset_similarity","text":"sim_result result similarity_from_gtf transcript_ids character vector transcript IDs subset match_without_version logical, try matching without version numbers","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/subset_similarity.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create similarity matrix for a subset of transcripts — subset_similarity","text":"subsetted similarity matrix","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/summary.isotwas_model.html","id":null,"dir":"Reference","previous_headings":"","what":"Summary method for isotwas_model — summary.isotwas_model","title":"Summary method for isotwas_model — summary.isotwas_model","text":"Summary method isotwas_model","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/summary.isotwas_model.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summary method for isotwas_model — summary.isotwas_model","text":"","code":"# S3 method for class 'isotwas_model' summary(object, ...)"},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/summary.isotwas_model.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summary method for isotwas_model — summary.isotwas_model","text":"object isotwas_model object ... Additional arguments (unused)","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/summary.isotwas_model.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summary method for isotwas_model — summary.isotwas_model","text":"data.frame per-transcript summary statistics","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/summary.isotwas_result.html","id":null,"dir":"Reference","previous_headings":"","what":"Summary method for isotwas_result — summary.isotwas_result","title":"Summary method for isotwas_result — summary.isotwas_result","text":"Summary method isotwas_result","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/summary.isotwas_result.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summary method for isotwas_result — summary.isotwas_result","text":"","code":"# S3 method for class 'isotwas_result' summary(object, ...)"},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/summary.isotwas_result.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summary method for isotwas_result — summary.isotwas_result","text":"object isotwas_result object ... Additional arguments (unused)","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/twas_finemap.html","id":null,"dir":"Reference","previous_headings":"","what":"FOCUS-like gene-level finemapping — twas_finemap","title":"FOCUS-like gene-level finemapping — twas_finemap","text":"function runs probabilistic finemapping gene/isoform-level","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/twas_finemap.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"FOCUS-like gene-level finemapping — twas_finemap","text":"","code":"twas_finemap(   res.df,   z = \"Z\",   Omega,   V,   max_enum = 3,   cutoff = 0.9,   verbose = F )"},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/twas_finemap.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"FOCUS-like gene-level finemapping — twas_finemap","text":"res.df data.frame, TWAS results least Z scores transcript names z character, column name Z scores Omega matrix, matrix SNP transcript effect order res.df V matrix, LD matrix order Omega max_enum numeric, max number causals credible set cutoff numeric, proportion posterior explained credible set verbose logical, verbose","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/twas_finemap.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"FOCUS-like gene-level finemapping — twas_finemap","text":"data frame res.df pips whether isoform credible set","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/univariate_blup.html","id":null,"dir":"Reference","previous_headings":"","what":"Univariate BLUP on all columns — univariate_blup","title":"Univariate BLUP on all columns — univariate_blup","text":"function trains unvariate rrBLUP models individually isoform transcripts","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/univariate_blup.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Univariate BLUP on all columns — univariate_blup","text":"","code":"univariate_blup(   X,   Y,   Omega,   scale = F,   nfolds = 5,   verbose,   par = F,   n.cores = NULL,   tx_names = NULL,   seed )"},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/univariate_blup.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Univariate BLUP on all columns — univariate_blup","text":"X matrix, design matrix SNP dosages Y matrix, matrix G isoform expression across columns Omega matrix, precision matrix Y scale logical, T/F scale Y Omega nfolds int, number CV folds verbose logical par logical, uses mclapply parallelize model fit n.cores int, number parallel cores tx_names vector, character vector tx names order columns Y seed int, random seed","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/univariate_blup.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Univariate BLUP on all columns — univariate_blup","text":"data frame elastic net, lasso, LMM based predictions","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/univariate_elasticnet.html","id":null,"dir":"Reference","previous_headings":"","what":"Univariate elastic net on all columns — univariate_elasticnet","title":"Univariate elastic net on all columns — univariate_elasticnet","text":"function trains unvariate elastic models individually isoform transcripts","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/univariate_elasticnet.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Univariate elastic net on all columns — univariate_elasticnet","text":"","code":"univariate_elasticnet(   X,   Y,   Omega,   family = \"gaussian\",   scale = F,   alpha = 0.5,   nfolds = 5,   verbose,   par = F,   n.cores = NULL,   tx_names = NULL,   seed )"},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/univariate_elasticnet.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Univariate elastic net on all columns — univariate_elasticnet","text":"X matrix, design matrix SNP dosages Y matrix, matrix G isoform expression across columns Omega matrix, precision matrix Y family character, glmnet glm family scale logical, T/F scale Y Omega alpha numeric, elastic net mixing parameter nfolds int, number CV folds verbose logical par logical, uses mclapply parallelize model fit n.cores int, number parallel cores tx_names vector, character vector tx names order columns Y seed int, random seed","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/univariate_elasticnet.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Univariate elastic net on all columns — univariate_elasticnet","text":"data frame elastic net, lasso, LMM based predictions","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/univariate_susie.html","id":null,"dir":"Reference","previous_headings":"","what":"Univariate SuSiE on all columns — univariate_susie","title":"Univariate SuSiE on all columns — univariate_susie","text":"function trains unvariate SuSiE models individually isoform transcripts","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/univariate_susie.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Univariate SuSiE on all columns — univariate_susie","text":"","code":"univariate_susie(   X,   Y,   Omega,   scale = F,   alpha = 0.5,   nfolds = 5,   verbose,   par = F,   n.cores = NULL,   tx_names = NULL,   seed )"},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/univariate_susie.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Univariate SuSiE on all columns — univariate_susie","text":"X matrix, design matrix SNP dosages Y matrix, matrix G isoform expression across columns Omega matrix, precision matrix Y scale logical, T/F scale Y Omega alpha numeric, elastic net mixing parameter nfolds int, number CV folds verbose logical par logical, uses mclapply parallelize model fit n.cores int, number parallel cores tx_names vector, character vector tx names order columns Y seed int, random seed","code":""},{"path":"https://bhattacharya-a-bt.github.io/isotwas/reference/univariate_susie.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Univariate SuSiE on all columns — univariate_susie","text":"data frame elastic net, lasso, LMM based predictions","code":""}]
