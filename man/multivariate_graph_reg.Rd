% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/multivariate_graph_reg.R
\name{multivariate_graph_reg}
\alias{multivariate_graph_reg}
\title{Multivariate Graph-Regularized Regression}
\usage{
multivariate_graph_reg(
  X,
  Y,
  similarity_matrix = NULL,
  lambda1 = NULL,
  lambda_graph = NULL,
  alpha = 0.5,
  nlambda = 15,
  nlambda_graph = 5,
  lambda_graph_seq = NULL,
  normalize_laplacian = FALSE,
  nfolds = 5,
  standardize = FALSE,
  verbose = FALSE,
  seed = 123
)
}
\arguments{
\item{X}{matrix, design matrix of SNP dosages (n x p)}

\item{Y}{matrix, matrix of isoform expression across columns (n x q)}

\item{similarity_matrix}{matrix, q x q symmetric matrix of pairwise isoform
similarities (e.g., Jaccard index of shared exons). Values should be >= 0.
If NULL, uses identity (no graph regularization, equivalent to lasso).}

\item{lambda1}{numeric or NULL, L1 penalty parameter. If NULL, selected by CV.}

\item{lambda_graph}{numeric or NULL, graph penalty parameter. If NULL, selected by CV.}

\item{alpha}{numeric, elastic net mixing (0 = ridge, 1 = lasso). Default 0.5.}

\item{nlambda}{int, number of lambda1 values to try in CV}

\item{nlambda_graph}{int, number of lambda_graph values to try in CV}

\item{lambda_graph_seq}{numeric vector, specific lambda_graph values to try.
If NULL, auto-generated.}

\item{normalize_laplacian}{logical, use normalized Laplacian. Default FALSE.}

\item{nfolds}{int, number of CV folds}

\item{standardize}{logical, standardize X before fitting}

\item{verbose}{logical, print progress}

\item{seed}{int, random seed}
}
\value{
isotwas_model object containing:
  \itemize{
    \item transcripts: list of transcript_model objects
    \item best_lambda1: optimal L1 penalty
    \item best_lambda_graph: optimal graph penalty
    \item laplacian: the Laplacian matrix used
  }
}
\description{
Fits a multivariate regression model with graph Laplacian regularization.
This method encourages isoforms that are similar (e.g., share exons) to have
similar prediction weight vectors.
}
\details{
The optimization problem is:
\deqn{\min_B \frac{1}{2n}||Y - XB||_F^2 + \lambda_1 ||B||_1 + \frac{\lambda_g}{2} \text{tr}(B^T B L)}

where L is the graph Laplacian computed from the similarity matrix:
\deqn{L = D - S}
with D being the degree matrix (diagonal with row sums of S).

The graph penalty encourages isoforms with high similarity to have similar
coefficient vectors across SNPs.


The similarity matrix encodes prior knowledge about isoform relationships.
For isoform-level TWAS, this is typically derived from shared exon structure:
isoforms sharing more exons are expected to have more similar cis-regulatory
effects, as they share more of the same genetic signal.
}
